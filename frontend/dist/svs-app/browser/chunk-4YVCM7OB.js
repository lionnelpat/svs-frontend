import{a as Cn}from"./chunk-I3XMGWCT.js";import{a as et,b as tt,c as nt}from"./chunk-VZDXDOBD.js";import{a as jt,b as qt,c as bn}from"./chunk-KVMJ3D4F.js";import{a as it,b as ot}from"./chunk-UB2NIRS6.js";import{c as Lt,o as Qt,p as Wt,q as Yt}from"./chunk-UVPANQHV.js";import{a as En}from"./chunk-ALE62QOC.js";import{$ as vn,A as nn,B as on,C as rn,D as an,G as sn,H as ln,I as pn,J as dn,K as cn,L as He,M as We,N as Ye,O as Ge,P as Je,Q as un,S as mn,W as hn,X as gn,Y as _n,Z as fn,_ as xn,aa as Ke,ba as Ze,f as kt,g as Nt,j as $t,k as je,l as Ie,m as be,n as Xt,p as Gt,q as Jt,r as Kt,s as Zt,t as en,v as Xe,w as O,y as Qe,z as tn}from"./chunk-Y5JEGQKB.js";import"./chunk-S35HUXPS.js";import{Aa as Ht,Ba as qe,C as Dt,F as Fe,I as Ut,K as At,Y as Vt,_ as ut,b as N,c as Be,ca as re,e as $e,ga as J,ha as B,i as we,ia as K,j as Te,ka as xe,l as fe,ma as ae,s as Me,ta as zt,xa as Bt,ya as ve,za as Ee}from"./chunk-ZXANPB2F.js";import{$a as X,$b as Ft,Bb as _,Cb as d,Cc as me,D as gt,Db as Ae,Dc as ke,Eb as Ve,Ec as k,Fc as he,Gb as yt,Gc as ge,Hb as F,Hc as Ne,Ib as W,Ja as Et,Jb as C,Jc as Rt,Kb as y,Kc as U,L as b,Lb as St,Ma as s,Mb as wt,Mc as _e,Nb as Tt,O as _t,Ob as c,P as H,Pb as I,Q as pe,Qb as T,Rb as ce,Sb as R,Tb as L,U as Le,Ua as bt,Ub as D,V as v,Vb as Y,Wb as Mt,Xa as P,Xb as ze,Ya as de,aa as ft,ba as h,bb as De,ca as g,cb as u,cc as It,da as xt,ec as ie,f as q,fa as A,gc as ue,hc as Ot,ic as ct,jb as x,k as ht,ka as w,kb as p,la as vt,lb as Ct,mb as j,mc as G,n as M,nb as Ue,nc as oe,ob as V,oc as Pt,pb as ee,qb as lt,rb as pt,sb as dt,tb as r,ub as a,vb as f,w as S,wb as te,xb as ne,y as Se,yb as z,zb as E}from"./chunk-TX7UWVJS.js";import{a as le,b as Re}from"./chunk-EQDQRRRY.js";var yn=(()=>{class n extends zt{pathId;ngOnInit(){this.pathId="url(#"+Vt()+")"}static \u0275fac=(()=>{let e;return function(o){return(e||(e=A(n)))(o||n)}})();static \u0275cmp=P({type:n,selectors:[["UploadIcon"]],features:[X],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M6.58942 9.82197C6.70165 9.93405 6.85328 9.99793 7.012 10C7.17071 9.99793 7.32234 9.93405 7.43458 9.82197C7.54681 9.7099 7.61079 9.55849 7.61286 9.4V2.04798L9.79204 4.22402C9.84752 4.28011 9.91365 4.32457 9.98657 4.35479C10.0595 4.38502 10.1377 4.40039 10.2167 4.40002C10.2956 4.40039 10.3738 4.38502 10.4467 4.35479C10.5197 4.32457 10.5858 4.28011 10.6413 4.22402C10.7538 4.11152 10.817 3.95902 10.817 3.80002C10.817 3.64102 10.7538 3.48852 10.6413 3.37602L7.45127 0.190618C7.44656 0.185584 7.44176 0.180622 7.43687 0.175736C7.32419 0.063214 7.17136 0 7.012 0C6.85264 0 6.69981 0.063214 6.58712 0.175736C6.58181 0.181045 6.5766 0.186443 6.5715 0.191927L3.38282 3.37602C3.27669 3.48976 3.2189 3.6402 3.22165 3.79564C3.2244 3.95108 3.28746 4.09939 3.39755 4.20932C3.50764 4.31925 3.65616 4.38222 3.81182 4.38496C3.96749 4.3877 4.11814 4.33001 4.23204 4.22402L6.41113 2.04807V9.4C6.41321 9.55849 6.47718 9.7099 6.58942 9.82197ZM11.9952 14H2.02883C1.751 13.9887 1.47813 13.9228 1.22584 13.8061C0.973545 13.6894 0.746779 13.5241 0.558517 13.3197C0.370254 13.1154 0.22419 12.876 0.128681 12.6152C0.0331723 12.3545 -0.00990605 12.0775 0.0019109 11.8V9.40005C0.0019109 9.24092 0.065216 9.08831 0.1779 8.97579C0.290584 8.86326 0.443416 8.80005 0.602775 8.80005C0.762134 8.80005 0.914966 8.86326 1.02765 8.97579C1.14033 9.08831 1.20364 9.24092 1.20364 9.40005V11.8C1.18295 12.0376 1.25463 12.274 1.40379 12.4602C1.55296 12.6463 1.76817 12.7681 2.00479 12.8H11.9952C12.2318 12.7681 12.447 12.6463 12.5962 12.4602C12.7453 12.274 12.817 12.0376 12.7963 11.8V9.40005C12.7963 9.24092 12.8596 9.08831 12.9723 8.97579C13.085 8.86326 13.2378 8.80005 13.3972 8.80005C13.5565 8.80005 13.7094 8.86326 13.8221 8.97579C13.9347 9.08831 13.998 9.24092 13.998 9.40005V11.8C14.022 12.3563 13.8251 12.8996 13.45 13.3116C13.0749 13.7236 12.552 13.971 11.9952 14Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(i,o){i&1&&(xt(),r(0,"svg",0)(1,"g"),f(2,"path",1),a(),r(3,"defs")(4,"clipPath",2),f(5,"rect",3),a()()()),i&2&&(V(o.getClassNames()),x("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role),s(),x("clip-path",o.pathId),s(3),p("id",o.pathId))},encapsulation:2})}return n})();var Dn=["start"],Un=["end"],An=["center"],Vn=["*"];function zn(n,t){n&1&&z(0)}function kn(n,t){if(n&1&&(r(0,"div",4),u(1,zn,1,0,"ng-container",5),a()),n&2){let e=d();x("data-pc-section","start"),s(),p("ngTemplateOutlet",e.startTemplate||e._startTemplate)}}function Nn(n,t){n&1&&z(0)}function Bn(n,t){if(n&1&&(r(0,"div",6),u(1,Nn,1,0,"ng-container",5),a()),n&2){let e=d();x("data-pc-section","center"),s(),p("ngTemplateOutlet",e.centerTemplate||e._centerTemplate)}}function $n(n,t){n&1&&z(0)}function jn(n,t){if(n&1&&(r(0,"div",7),u(1,$n,1,0,"ng-container",5),a()),n&2){let e=d();x("data-pc-section","end"),s(),p("ngTemplateOutlet",e.endTemplate||e._endTemplate)}}var qn=({dt:n})=>`
.p-toolbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    padding: ${n("toolbar.padding")};
    background: ${n("toolbar.background")};
    border: 1px solid ${n("toolbar.border.color")};
    color: ${n("toolbar.color")};
    border-radius: ${n("toolbar.border.radius")};
    gap: ${n("toolbar.gap")};
}

.p-toolbar-start,
.p-toolbar-center,
.p-toolbar-end {
    display: flex;
    align-items: center;
}
`,Xn={root:"p-toolbar p-component",start:"p-toolbar-start",center:"p-toolbar-center",end:"p-toolbar-end"},Sn=(()=>{class n extends xe{name="toolbar";theme=qn;classes=Xn;static \u0275fac=(()=>{let e;return function(o){return(e||(e=A(n)))(o||n)}})();static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})();var Qn=(()=>{class n extends ae{style;styleClass;ariaLabelledBy;_componentStyle=v(Sn);getBlockableElement(){return this.el.nativeElement.children[0]}startTemplate;endTemplate;centerTemplate;templates;_startTemplate;_endTemplate;_centerTemplate;ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"start":case"left":this._startTemplate=e.template;break;case"end":case"right":this._endTemplate=e.template;break;case"center":this._centerTemplate=e.template;break}})}static \u0275fac=(()=>{let e;return function(o){return(e||(e=A(n)))(o||n)}})();static \u0275cmp=P({type:n,selectors:[["p-toolbar"]],contentQueries:function(i,o,l){if(i&1&&(F(l,Dn,4),F(l,Un,4),F(l,An,4),F(l,J,4)),i&2){let m;C(m=y())&&(o.startTemplate=m.first),C(m=y())&&(o.endTemplate=m.first),C(m=y())&&(o.centerTemplate=m.first),C(m=y())&&(o.templates=m)}},inputs:{style:"style",styleClass:"styleClass",ariaLabelledBy:"ariaLabelledBy"},features:[Y([Sn]),X],ngContentSelectors:Vn,decls:5,vars:9,consts:[["role","toolbar",3,"ngClass","ngStyle"],["class","p-toolbar-start",4,"ngIf"],["class","p-toolbar-center",4,"ngIf"],["class","p-toolbar-end",4,"ngIf"],[1,"p-toolbar-start"],[4,"ngTemplateOutlet"],[1,"p-toolbar-center"],[1,"p-toolbar-end"]],template:function(i,o){i&1&&(Ae(),r(0,"div",0),Ve(1),u(2,kn,2,2,"div",1)(3,Bn,2,2,"div",2)(4,jn,2,2,"div",3),a()),i&2&&(V(o.styleClass),p("ngClass","p-toolbar p-component")("ngStyle",o.style),x("aria-labelledby",o.ariaLabelledBy)("data-pc-name","toolbar"),s(2),p("ngIf",o.startTemplate||o._startTemplate),s(),p("ngIf",o.centerTemplate||o._centerTemplate),s(),p("ngIf",o.endTemplate||o._endTemplate))},dependencies:[U,me,k,ge,he,B],encapsulation:2,changeDetection:0})}return n})(),wn=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=de({type:n});static \u0275inj=pe({imports:[Qn,B,B]})}return n})();var Hn=["*"],Wn=["panel"],Yn=["container"],Gn=n=>({display:"flex","flex-wrap":"nowrap","flex-direction":n});function Jn(n,t){n&1&&z(0)}function Kn(n,t){if(n&1){let e=E();r(0,"div",6),_("mousedown",function(o){h(e);let l=d().index,m=d();return g(m.onGutterMouseDown(o,l))})("touchstart",function(o){h(e);let l=d().index,m=d();return g(m.onGutterTouchStart(o,l))})("touchmove",function(o){h(e);let l=d(2);return g(l.onGutterTouchMove(o))})("touchend",function(o){h(e);let l=d(2);return g(l.onGutterTouchEnd(o))}),r(1,"div",7),_("keyup",function(o){h(e);let l=d(2);return g(l.onGutterKeyUp(o))})("keydown",function(o){h(e);let l=d().index,m=d();return g(m.onGutterKeyDown(o,l))}),a()()}if(n&2){let e=d(2);x("data-p-gutter-resizing",!1)("data-pc-section","gutter"),s(),p("ngStyle",e.gutterStyle()),x("aria-orientation",e.layout)("aria-valuenow",e.prevSize)("data-pc-section","gutterhandle")}}function Zn(n,t){if(n&1&&(r(0,"div",3),u(1,Jn,1,0,"ng-container",4),a(),u(2,Kn,2,6,"div",5)),n&2){let e=t.$implicit,i=t.index,o=d();V(o.panelStyleClass),p("ngClass",o.panelContainerClass())("ngStyle",o.panelStyle),x("data-pc-name","splitter")("data-pc-section","root"),s(),p("ngTemplateOutlet",e),s(),p("ngIf",i!==o.panels.length-1)}}var ei=({dt:n})=>`
.p-splitter {
    display: flex;
    flex-wrap: nowrap;
    border: 1px solid ${n("splitter.border.color")};
    background: ${n("splitter.background")};
    border-radius: ${n("border.radius.md")};
    color: ${n("splitter.color")};
}

.p-splitter-vertical {
    flex-direction: column;
}

.p-splitter-gutter {
    flex-grow: 0;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1;
    background: ${n("splitter.gutter.background")};
}

.p-splitter-gutter-handle {
    border-radius: ${n("splitter.handle.border.radius")};
    background: ${n("splitter.handle.background")};
    transition: outline-color ${n("splitter.transition.duration")}, box-shadow ${n("splitter.transition.duration")};
    outline-color: transparent;
}

.p-splitter-gutter-handle:focus-visible {
    box-shadow: ${n("splitter.handle.focus.ring.shadow")};
    outline: ${n("splitter.handle.focus.ring.width")} ${n("splitter.handle.focus.ring.style")} ${n("splitter.handle.focus.ring.color")};
    outline-offset: ${n("splitter.handle.focus.ring.offset")};
}

.p-splitter-horizontal.p-splitter-resizing {
    cursor: col-resize;
    user-select: none;
}

.p-splitter-vertical.p-splitter-resizing {
    cursor: row-resize;
    user-select: none;
}

.p-splitter-horizontal > .p-splitter-gutter > .p-splitter-gutter-handle {
    height: ${n("splitter.handle.size")};
    width: 100%;
}

.p-splitter-vertical > .p-splitter-gutter > .p-splitter-gutter-handle {
    width: ${n("splitter.handle.size")};
    height: 100%;
}

.p-splitter-horizontal > .p-splitter-gutter {
    cursor: col-resize;
}

.p-splitter-vertical > .p-splitter-gutter {
    cursor: row-resize;
}

.p-splitterpanel {
    flex-grow: 1;
    overflow: hidden;
}

.p-splitterpanel-nested {
    display: flex;
    flex-grow: 1;
    justify-content: center;
}

.p-splitterpanel .p-splitter {
    flex-grow: 1;
    border: 0 none;
}
`,ti={root:({props:n})=>["p-splitter p-component","p-splitter-"+n.layout],gutter:"p-splitter-gutter",gutterHandle:"p-splitter-gutter-handle"},Tn=(()=>{class n extends xe{name="splitter";theme=ei;classes=ti;static \u0275fac=(()=>{let e;return function(o){return(e||(e=A(n)))(o||n)}})();static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})();var ni=(()=>{class n extends ae{splitter=bt(_t(()=>mt));nestedState=Pt(()=>this.splitter());static \u0275fac=(()=>{let e;return function(o){return(e||(e=A(n)))(o||n)}})();static \u0275cmp=P({type:n,selectors:[["p-splitter-panel"]],contentQueries:function(i,o,l){i&1&&St(l,o.splitter,mt,5),i&2&&wt()},hostAttrs:[1,"p-splitterpanel"],features:[X],ngContentSelectors:Hn,decls:1,vars:0,template:function(i,o){i&1&&(Ae(),Ve(0))},dependencies:[U],encapsulation:2,changeDetection:0})}return n})(),mt=(()=>{class n extends ae{styleClass;panelStyleClass;style;panelStyle;stateStorage="session";stateKey=null;layout="horizontal";gutterSize=4;step=5;minSizes=[];get panelSizes(){return this._panelSizes}set panelSizes(e){if(this._panelSizes=e,this.el&&this.el.nativeElement&&this.panels.length>0){let i=[...this.el.nativeElement.children[0].children].filter(l=>we(l,"p-splitterpanel")),o=[];this.panels.map((l,m)=>{let ye=(this.panelSizes.length-1>=m?this.panelSizes[m]:null)||100/this.panels.length;o[m]=ye,i[m].style.flexBasis="calc("+ye+"% - "+(this.panels.length-1)*this.gutterSize+"px)"})}}onResizeEnd=new w;onResizeStart=new w;containerViewChild;templates;panelChildren;nested=!1;panels=[];dragging=!1;mouseMoveListener;mouseUpListener;touchMoveListener;touchEndListener;size;gutterElement;startPos;prevPanelElement;nextPanelElement;nextPanelSize;prevPanelSize;_panelSizes=[];prevPanelIndex;timer;prevSize;_componentStyle=v(Tn);ngOnInit(){super.ngOnInit(),this.nested=this.isNested()}ngAfterContentInit(){this.templates&&this.templates.toArray().length>0&&this.templates.forEach(e=>{switch(e.getType()){case"panel":this.panels.push(e.template);break;default:this.panels.push(e.template);break}}),this.panelChildren&&this.panelChildren.toArray().length>0&&this.panelChildren.forEach(e=>{this.panels.push(e)})}ngAfterViewInit(){if(super.ngAfterViewInit(),_e(this.platformId)&&this.panels&&this.panels.length){let e=!1;if(this.isStateful()&&(e=this.restoreState()),!e){let i=[...this.el.nativeElement.children[0].children].filter(l=>we(l,"p-splitterpanel")),o=[];this.panels.map((l,m)=>{let ye=(this.panelSizes.length-1>=m?this.panelSizes[m]:null)||100/this.panels.length;o[m]=ye,i[m].style.flexBasis="calc("+ye+"% - "+(this.panels.length-1)*this.gutterSize+"px)"}),this._panelSizes=o,this.prevSize=parseFloat(o[0]).toFixed(4)}}}resizeStart(e,i,o){this.gutterElement=e.currentTarget||e.target.parentElement,this.size=this.horizontal()?Ut(this.containerViewChild.nativeElement):Dt(this.containerViewChild.nativeElement),o||(this.dragging=!0,this.startPos=this.horizontal()?e instanceof MouseEvent?e.pageX:e.changedTouches[0].pageX:e instanceof MouseEvent?e.pageY:e.changedTouches[0].pageY),this.prevPanelElement=this.gutterElement.previousElementSibling,this.nextPanelElement=this.gutterElement.nextElementSibling,o?(this.prevPanelSize=this.horizontal()?Me(this.prevPanelElement,!0):Fe(this.prevPanelElement,!0),this.nextPanelSize=this.horizontal()?Me(this.nextPanelElement,!0):Fe(this.nextPanelElement,!0)):(this.prevPanelSize=100*(this.horizontal()?Me(this.prevPanelElement,!0):Fe(this.prevPanelElement,!0))/this.size,this.nextPanelSize=100*(this.horizontal()?Me(this.nextPanelElement,!0):Fe(this.nextPanelElement,!0))/this.size),this.prevPanelIndex=i,Te(this.gutterElement,"p-splitter-gutter-resizing"),this.gutterElement.setAttribute("data-p-gutter-resizing","true"),Te(this.containerViewChild.nativeElement,"p-splitter-resizing"),this.containerViewChild.nativeElement.setAttribute("data-p-resizing","true"),this.onResizeStart.emit({originalEvent:e,sizes:this._panelSizes})}onResize(e,i,o){let l,m,$;o?this.horizontal()?(m=100*(this.prevPanelSize+i)/this.size,$=100*(this.nextPanelSize-i)/this.size):(m=100*(this.prevPanelSize-i)/this.size,$=100*(this.nextPanelSize+i)/this.size):(this.horizontal()?At(this.el.nativeElement)?l=(this.startPos-e.pageX)*100/this.size:l=(e.pageX-this.startPos)*100/this.size:l=(e.pageY-this.startPos)*100/this.size,m=this.prevPanelSize+l,$=this.nextPanelSize-l),this.prevSize=parseFloat(m).toFixed(4),this.validateResize(m,$)&&(this.prevPanelElement.style.flexBasis="calc("+m+"% - "+(this.panels.length-1)*this.gutterSize+"px)",this.nextPanelElement.style.flexBasis="calc("+$+"% - "+(this.panels.length-1)*this.gutterSize+"px)",this._panelSizes[this.prevPanelIndex]=m,this._panelSizes[this.prevPanelIndex+1]=$)}resizeEnd(e){this.isStateful()&&this.saveState(),this.onResizeEnd.emit({originalEvent:e,sizes:this._panelSizes}),fe(this.gutterElement,"p-splitter-gutter-resizing"),fe(this.containerViewChild.nativeElement,"p-splitter-resizing"),this.clear()}onGutterMouseDown(e,i){this.resizeStart(e,i),this.bindMouseListeners()}onGutterTouchStart(e,i){e.cancelable&&(this.resizeStart(e,i),this.bindTouchListeners(),e.preventDefault())}onGutterTouchMove(e){this.onResize(e),e.preventDefault()}onGutterTouchEnd(e){this.resizeEnd(e),this.unbindTouchListeners(),e.cancelable&&e.preventDefault()}repeat(e,i,o){this.resizeStart(e,i,!0),this.onResize(e,o,!0)}setTimer(e,i,o){this.clearTimer(),this.timer=setTimeout(()=>{this.repeat(e,i,o)},40)}clearTimer(){this.timer&&clearTimeout(this.timer)}onGutterKeyUp(e){this.clearTimer(),this.resizeEnd(e)}onGutterKeyDown(e,i){switch(e.code){case"ArrowLeft":{this.layout==="horizontal"&&this.setTimer(e,i,this.step*-1),e.preventDefault();break}case"ArrowRight":{this.layout==="horizontal"&&this.setTimer(e,i,this.step),e.preventDefault();break}case"ArrowDown":{this.layout==="vertical"&&this.setTimer(e,i,this.step*-1),e.preventDefault();break}case"ArrowUp":{this.layout==="vertical"&&this.setTimer(e,i,this.step),e.preventDefault();break}default:break}}validateResize(e,i){return!(this.minSizes.length>=1&&this.minSizes[0]&&this.minSizes[0]>e||this.minSizes.length>1&&this.minSizes[1]&&this.minSizes[1]>i)}bindMouseListeners(){this.mouseMoveListener||(this.mouseMoveListener=this.renderer.listen(this.document,"mousemove",e=>{this.onResize(e)})),this.mouseUpListener||(this.mouseUpListener=this.renderer.listen(this.document,"mouseup",e=>{this.resizeEnd(e),this.unbindMouseListeners()}))}bindTouchListeners(){this.touchMoveListener||(this.touchMoveListener=this.renderer.listen(this.document,"touchmove",e=>{this.onResize(e.changedTouches[0])})),this.touchEndListener||(this.touchEndListener=this.renderer.listen(this.document,"touchend",e=>{this.resizeEnd(e),this.unbindTouchListeners()}))}unbindMouseListeners(){this.mouseMoveListener&&(this.mouseMoveListener(),this.mouseMoveListener=null),this.mouseUpListener&&(this.mouseUpListener(),this.mouseUpListener=null)}unbindTouchListeners(){this.touchMoveListener&&(this.touchMoveListener(),this.touchMoveListener=null),this.touchEndListener&&(this.touchEndListener(),this.touchEndListener=null)}clear(){this.dragging=!1,this.size=null,this.startPos=null,this.prevPanelElement=null,this.nextPanelElement=null,this.prevPanelSize=null,this.nextPanelSize=null,this.gutterElement=null,this.prevPanelIndex=null}isNested(){if(this.el.nativeElement){let e=this.el.nativeElement.parentElement;for(;e&&!we(e,"p-splitter");)e=e.parentElement;return e!==null}else return!1}isStateful(){return this.stateKey!=null}getStorage(){if(_e(this.platformId))switch(this.stateStorage){case"local":return this.document.defaultView.localStorage;case"session":return this.document.defaultView.sessionStorage;default:throw new Error(this.stateStorage+' is not a valid value for the state storage, supported values are "local" and "session".')}else throw new Error("Storage is not a available by default on the server.")}saveState(){this.getStorage().setItem(this.stateKey,JSON.stringify(this._panelSizes))}restoreState(){let i=this.getStorage().getItem(this.stateKey);return i?(this._panelSizes=JSON.parse(i),[...this.containerViewChild.nativeElement.children].filter(l=>we(l,"p-splitterpanel")).forEach((l,m)=>{l.style.flexBasis="calc("+this._panelSizes[m]+"% - "+(this.panels.length-1)*this.gutterSize+"px)"}),!0):!1}containerClass(){return{"p-splitter p-component":!0,"p-splitter-horizontal":this.layout==="horizontal","p-splitter-vertical":this.layout==="vertical"}}panelContainerClass(){return{"p-splitterpanel":!0,"p-splitterpanel-nested":!0}}gutterStyle(){return this.horizontal()?{width:this.gutterSize+"px"}:{height:this.gutterSize+"px"}}horizontal(){return this.layout==="horizontal"}static \u0275fac=(()=>{let e;return function(o){return(e||(e=A(n)))(o||n)}})();static \u0275cmp=P({type:n,selectors:[["p-splitter"]],contentQueries:function(i,o,l){if(i&1&&(F(l,J,4),F(l,Wn,4)),i&2){let m;C(m=y())&&(o.templates=m),C(m=y())&&(o.panelChildren=m)}},viewQuery:function(i,o){if(i&1&&W(Yn,5),i&2){let l;C(l=y())&&(o.containerViewChild=l.first)}},hostVars:2,hostBindings:function(i,o){i&2&&j("p-splitterpanel-nested",o.nested)},inputs:{styleClass:"styleClass",panelStyleClass:"panelStyleClass",style:"style",panelStyle:"panelStyle",stateStorage:"stateStorage",stateKey:"stateKey",layout:"layout",gutterSize:[2,"gutterSize","gutterSize",oe],step:[2,"step","step",oe],minSizes:"minSizes",panelSizes:"panelSizes"},outputs:{onResizeEnd:"onResizeEnd",onResizeStart:"onResizeStart"},features:[Y([Tn]),De,X],decls:3,vars:12,consts:[["container",""],[3,"ngClass","ngStyle"],["ngFor","",3,"ngForOf"],["tabindex","-1",3,"ngClass","ngStyle"],[4,"ngTemplateOutlet"],["class","p-splitter-gutter","role","separator","tabindex","-1",3,"mousedown","touchstart","touchmove","touchend",4,"ngIf"],["role","separator","tabindex","-1",1,"p-splitter-gutter",3,"mousedown","touchstart","touchmove","touchend"],["tabindex","0",1,"p-splitter-gutter-handle",3,"keyup","keydown","ngStyle"]],template:function(i,o){i&1&&(r(0,"div",1,0),u(2,Zn,3,8,"ng-template",2),a()),i&2&&(Ue(ze(10,Gn,o.layout==="vertical"?"column":"")),V(o.styleClass),p("ngClass",o.containerClass())("ngStyle",o.style),x("data-pc-name","splitter")("data-p-gutter-resizing",!1)("data-pc-section","root"),s(2),p("ngForOf",o.panels))},dependencies:[U,me,ke,k,ge,he,B],encapsulation:2,changeDetection:0})}return n})(),Mn=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=de({type:n});static \u0275inj=pe({imports:[mt,ni,B,B]})}return n})();var Z=class n{constructor(t,e,i){this.http=t;this.logger=e;this.errorHandler=i;this.logger.info("ExpenseService initialis\xE9")}apiUrl=`${Ie.apiBaseUrl}/${Ie.apiVersion}/expenses`;createExpense(t){return this.logger.info("Cr\xE9ation d'une nouvelle d\xE9pense",t),this.http.post(`${this.apiUrl}`,t).pipe(M(e=>this.mapExpenseResponse(e.data)),S(e=>this.handleError(e,"Cr\xE9ation de la d\xE9pense")))}updateExpense(t,e){return this.logger.info(`Mise \xE0 jour de la d\xE9pense ${t}`,e),this.http.put(`${this.apiUrl}/${t}`,e).pipe(M(i=>this.mapExpenseResponse(i.data)),S(i=>this.handleError(i,"Mise \xE0 jour de la d\xE9pense")))}getExpenseById(t){return this.logger.info(`R\xE9cup\xE9ration de la d\xE9pense ${t}`),this.http.get(`${this.apiUrl}/${t}`).pipe(M(e=>this.mapExpenseResponse(e.data)),S(e=>this.handleError(e,"R\xE9cup\xE9ration de la d\xE9pense")))}deleteExpense(t){return this.logger.info(`Suppression de la d\xE9pense ${t}`),this.http.delete(`${this.apiUrl}/${t}`).pipe(M(()=>{}),S(e=>this.handleError(e,"Suppression de la d\xE9pense")))}getExpenses(t){this.logger.info("R\xE9cup\xE9ration des d\xE9penses avec filtres",t);let e=this.mapToSearchFilter(t),i=this.buildHttpParams(e);return this.http.get(`${this.apiUrl}`,{params:i}).pipe(M(o=>this.mapPageResponse(o.data)),S(o=>this.handleError(o,"R\xE9cup\xE9ration des d\xE9penses")))}searchExpenses(t,e=0,i=20){this.logger.info(`Recherche textuelle: "${t}"`);let o=new N().set("query",t).set("page",e.toString()).set("size",i.toString()).set("sortBy","dateDepense").set("sortDirection","desc");return this.http.get(`${this.apiUrl}/search`,{params:o}).pipe(M(l=>this.mapPageResponse(l.data)),S(l=>this.handleError(l,"Recherche de d\xE9penses")))}filterExpenses(t){return this.logger.info("Filtrage avanc\xE9 des d\xE9penses",t),this.http.post(`${this.apiUrl}/filter`,t).pipe(M(e=>this.mapPageResponse(e.data)),S(e=>this.handleError(e,"Filtrage des d\xE9penses")))}getExpensesByCategory(t,e=0,i=20){this.logger.info(`D\xE9penses par cat\xE9gorie ${t}`);let o=new N().set("page",e.toString()).set("size",i.toString());return this.http.get(`${this.apiUrl}/category/${t}`,{params:o}).pipe(M(l=>this.mapPageResponse(l.data)),S(l=>this.handleError(l,"D\xE9penses par cat\xE9gorie")))}getExpensesBySupplier(t,e=0,i=20){this.logger.info(`D\xE9penses par fournisseur ${t}`);let o=new N().set("page",e.toString()).set("size",i.toString());return this.http.get(`${this.apiUrl}/supplier/${t}`,{params:o}).pipe(M(l=>this.mapPageResponse(l.data)),S(l=>this.handleError(l,"D\xE9penses par fournisseur")))}getExpensesByStatus(t,e=0,i=20){this.logger.info(`D\xE9penses par statut ${t}`);let o=new N().set("page",e.toString()).set("size",i.toString());return this.http.get(`${this.apiUrl}/status/${t}`,{params:o}).pipe(M(l=>this.mapPageResponse(l.data)),S(l=>this.handleError(l,"D\xE9penses par statut")))}resetSearch(t=0,e=20){this.logger.info("R\xE9initialisation de la recherche");let i=new N().set("page",t.toString()).set("size",e.toString());return this.http.post(`${this.apiUrl}/reset-search`,{},{params:i}).pipe(M(o=>this.mapPageResponse(o.data)),S(o=>this.handleError(o,"R\xE9initialisation de la recherche")))}changeExpenseStatus(t,e){return this.logger.info(`Changement de statut de la d\xE9pense ${t}`,e),this.http.put(`${this.apiUrl}/${t}/status`,e).pipe(M(i=>this.mapExpenseResponse(i.data)),S(i=>this.handleError(i,"Changement de statut")))}approveExpense(t,e){this.logger.info(`Approbation de la d\xE9pense ${t}`);let i=new N;return e&&(i=i.set("commentaire",e)),this.http.patch(`${this.apiUrl}/${t}/approve`,{},{params:i}).pipe(M(o=>this.mapExpenseResponse(o.data)),S(o=>this.handleError(o,"Approbation de la d\xE9pense")))}rejectExpense(t,e){this.logger.info(`Rejet de la d\xE9pense ${t}`);let i=new N().set("commentaire",e);return this.http.patch(`${this.apiUrl}/${t}/reject`,{},{params:i}).pipe(M(o=>this.mapExpenseResponse(o.data)),S(o=>this.handleError(o,"Rejet de la d\xE9pense")))}markExpenseAsPaid(t,e){this.logger.info(`Marquage comme pay\xE9e de la d\xE9pense ${t}`);let i=new N;return e&&(i=i.set("commentaire",e)),this.http.patch(`${this.apiUrl}/${t}/mark-paid`,{},{params:i}).pipe(M(o=>this.mapExpenseResponse(o.data)),S(o=>this.handleError(o,"Marquage comme pay\xE9e")))}getPendingExpenses(){return this.logger.info("R\xE9cup\xE9ration des d\xE9penses en attente"),this.http.get(`${this.apiUrl}/pending`).pipe(M(t=>t.data.map(e=>this.mapExpenseResponse(e))),S(t=>this.handleError(t,"D\xE9penses en attente")))}getRecentExpenses(t=10){this.logger.info(`R\xE9cup\xE9ration des ${t} d\xE9penses r\xE9centes`);let e=new N().set("limit",t.toString());return this.http.get(`${this.apiUrl}/recent`,{params:e}).pipe(M(i=>i.data.map(o=>this.mapExpenseResponse(o))),S(i=>this.handleError(i,"D\xE9penses r\xE9centes")))}getExpenseStatistics(){return this.logger.info("R\xE9cup\xE9ration des statistiques des d\xE9penses"),this.http.get(`${this.apiUrl}/stats`).pipe(M(t=>t.data),S(t=>this.handleError(t,"Statistiques des d\xE9penses")))}exportToPdf(t){this.logger.info("Export PDF des d\xE9penses");let e=t||{};return this.http.post(`${this.apiUrl}/export/pdf`,e,{responseType:"blob",observe:"body"}).pipe(S(i=>this.handleError(i,"Export PDF")))}exportToExcel(t){this.logger.info("Export Excel des d\xE9penses");let e=t||{};return this.http.post(`${this.apiUrl}/export/excel`,e,{responseType:"blob",observe:"body"}).pipe(S(i=>this.handleError(i,"Export Excel")))}checkNumeroExists(t,e){this.logger.info(`V\xE9rification de l'existence du num\xE9ro ${t}`);let i=new N;return e&&(i=i.set("excludeId",e.toString())),this.http.get(`${this.apiUrl}/exists/numero/${t}`,{params:i}).pipe(M(o=>o.data),S(o=>this.handleError(o,"V\xE9rification du num\xE9ro")))}generateNumero(){return this.logger.info("G\xE9n\xE9ration d'un nouveau num\xE9ro"),this.http.get(`${this.apiUrl}/generate-numero`).pipe(M(t=>t.data),S(t=>this.handleError(t,"G\xE9n\xE9ration du num\xE9ro")))}mapToSearchFilter(t){if(!t)return{};let e={page:t.page||0,size:t.size||Ie.defaultPageSize,sortBy:"dateDepense",sortDirection:"desc"};return t.search&&(e.search=t.search),t.categorieId&&(e.categorieId=t.categorieId),t.fournisseurId&&(e.fournisseurId=t.fournisseurId),t.statut&&(e.statut=t.statut),t.paymentMethodId&&(e.paymentMethodId=t.paymentMethodId),t.montantMin&&(e.minAmount=t.montantMin),t.montantMax&&(e.maxAmount=t.montantMax),t.dateDebut&&(e.startDate=t.dateDebut),t.dateFin&&(e.endDate=t.dateFin),t.mois&&(e.month=t.mois),t.annee&&(e.year=t.annee),e}buildHttpParams(t){let e=new N().set("page",(t.page||0).toString()).set("size",(t.size||Ie.defaultPageSize).toString()).set("sortBy",t.sortBy||"dateDepense").set("sortDirection",t.sortDirection||"desc");return t.search&&(e=e.set("search",t.search)),t.categorieId&&(e=e.set("categorieId",t.categorieId.toString())),t.fournisseurId&&(e=e.set("fournisseurId",t.fournisseurId.toString())),t.statut&&(e=e.set("statut",t.statut)),t.paymentMethodId&&(e=e.set("paymentMethodId",t.paymentMethodId.toString())),t.minAmount&&(e=e.set("minAmount",t.minAmount.toString())),t.maxAmount&&(e=e.set("maxAmount",t.maxAmount.toString())),t.startDate&&(e=e.set("startDate",t.startDate.toISOString().split("T")[0])),t.endDate&&(e=e.set("endDate",t.endDate.toISOString().split("T")[0])),t.year&&(e=e.set("year",t.year.toString())),t.month&&(e=e.set("month",t.month.toString())),t.day&&(e=e.set("day",t.day.toString())),t.active!==void 0&&(e=e.set("active",t.active.toString())),e}mapExpenseResponse(t){return Re(le({},t),{dateDepense:new Date(t.dateDepense),createdAt:new Date(t.createdAt),updatedAt:new Date(t.updatedAt)})}mapPageResponse(t){return{expenses:t.expenses.map(e=>this.mapExpenseResponse(e)),total:t.total,page:t.page,size:t.size}}handleError(t,e){let i=t?.error?.message||t.message||"Erreur inconnue";return this.logger.error(`${e} - ${i}`,t),this.errorHandler.handleErrorWithContext(t,e),ht(()=>new Error(i))}static \u0275fac=function(e){return new(e||n)(Le($e),Le(be),Le(Xt))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};var Pe=(o=>(o.EN_ATTENTE="EN_ATTENTE",o.APPROUVEE="APPROUVEE",o.REJETEE="REJETEE",o.PAYEE="PAYEE",o))(Pe||{}),Ce=(e=>(e.XOF="XOF",e.EUR="EUR",e))(Ce||{});var Q={EN_ATTENTE:"En attente",APPROUVEE:"Approuv\xE9e",REJETEE:"Rejet\xE9e",PAYEE:"Pay\xE9e"};var Fn={XOF:"Franc CFA (XOF)",EUR:"Euro (EUR)"};var li=()=>[10,20,50,100];function pi(n,t){if(n&1){let e=E();r(0,"div",5)(1,"p-button",18),_("onClick",function(){h(e);let o=d();return g(o.exportToPdf())}),a(),r(2,"p-button",19),_("onClick",function(){h(e);let o=d();return g(o.exportToExcel())}),a()()}n&2&&(s(),p("outlined",!0),s(),p("outlined",!0))}function di(n,t){if(n&1){let e=E();r(0,"div",42)(1,"label",27),c(2,"Date"),a(),r(3,"p-calendar",43),D("ngModelChange",function(o){h(e);let l=d(2);return L(l.selectedDate,o)||(l.selectedDate=o),g(o)}),_("onSelect",function(){h(e);let o=d(2);return g(o.applyFilters())})("onClearClick",function(){h(e);let o=d(2);return g(o.applyFilters())}),a()()}if(n&2){let e=d(2);s(3),R("ngModel",e.selectedDate),p("showIcon",!0)}}function ci(n,t){if(n&1){let e=E();r(0,"div",44)(1,"div",45)(2,"label",27),c(3,"Mois"),a(),r(4,"p-dropdown",46),D("ngModelChange",function(o){h(e);let l=d(2);return L(l.selectedMonth,o)||(l.selectedMonth=o),g(o)}),_("onChange",function(){h(e);let o=d(2);return g(o.applyFilters())}),a()(),r(5,"div",47)(6,"label",27),c(7,"Ann\xE9e"),a(),r(8,"p-dropdown",48),D("ngModelChange",function(o){h(e);let l=d(2);return L(l.selectedYear,o)||(l.selectedYear=o),g(o)}),_("onChange",function(){h(e);let o=d(2);return g(o.applyFilters())}),a()()()}if(n&2){let e=d(2);s(4),R("ngModel",e.selectedMonth),p("options",e.monthOptions)("showClear",!0),s(4),R("ngModel",e.selectedYear),p("options",e.yearOptions)("showClear",!0)}}function ui(n,t){if(n&1){let e=E();r(0,"div",42)(1,"label",27),c(2,"Ann\xE9e"),a(),r(3,"p-dropdown",49),D("ngModelChange",function(o){h(e);let l=d(2);return L(l.selectedYear,o)||(l.selectedYear=o),g(o)}),_("onChange",function(){h(e);let o=d(2);return g(o.applyFilters())}),a()()}if(n&2){let e=d(2);s(3),R("ngModel",e.selectedYear),p("options",e.yearOptions)("showClear",!0)}}function mi(n,t){if(n&1){let e=E();r(0,"div",42)(1,"label",27),c(2,"P\xE9riode personnalis\xE9e"),a(),r(3,"p-calendar",50),D("ngModelChange",function(o){h(e);let l=d(2);return L(l.dateRange,o)||(l.dateRange=o),g(o)}),_("onSelect",function(){h(e);let o=d(2);return g(o.applyFilters())})("onClearClick",function(){h(e);let o=d(2);return g(o.applyFilters())}),a()()}if(n&2){let e=d(2);s(3),R("ngModel",e.dateRange),p("readonlyInput",!0)("showIcon",!0)}}function hi(n,t){if(n&1){let e=E();r(0,"div",51)(1,"div",52)(2,"label",53),c(3,"Montant entre:"),a(),r(4,"p-inputNumber",54),D("ngModelChange",function(o){h(e);let l=d(2);return L(l.minAmount,o)||(l.minAmount=o),g(o)}),_("onInput",function(){h(e);let o=d(2);return g(o.onAmountFilterChange())}),a(),r(5,"span",55),c(6,"et"),a(),r(7,"p-inputNumber",56),D("ngModelChange",function(o){h(e);let l=d(2);return L(l.maxAmount,o)||(l.maxAmount=o),g(o)}),_("onInput",function(){h(e);let o=d(2);return g(o.onAmountFilterChange())}),a()()()}if(n&2){let e=d(2);s(4),R("ngModel",e.minAmount),s(3),R("ngModel",e.maxAmount)}}function gi(n,t){if(n&1){let e=E();r(0,"div",20)(1,"div",21)(2,"p-iconfield",22)(3,"input",23),D("ngModelChange",function(o){h(e);let l=d();return L(l.searchTerm,o)||(l.searchTerm=o),g(o)}),_("input",function(){h(e);let o=d();return g(o.onSearchInputChange())}),a(),f(4,"p-inputicon",24),a()(),r(5,"div",25)(6,"div",26)(7,"label",27),c(8,"Cat\xE9gorie"),a(),r(9,"p-dropdown",28),D("ngModelChange",function(o){h(e);let l=d();return L(l.selectedCategory,o)||(l.selectedCategory=o),g(o)}),_("onChange",function(){h(e);let o=d();return g(o.applyFilters())}),a()(),r(10,"div",26)(11,"label",27),c(12,"Fournisseur"),a(),r(13,"p-dropdown",29),D("ngModelChange",function(o){h(e);let l=d();return L(l.selectedSupplier,o)||(l.selectedSupplier=o),g(o)}),_("onChange",function(){h(e);let o=d();return g(o.applyFilters())}),a()(),r(14,"div",26)(15,"label",27),c(16,"Statut"),a(),r(17,"p-dropdown",30),D("ngModelChange",function(o){h(e);let l=d();return L(l.selectedStatus,o)||(l.selectedStatus=o),g(o)}),_("onChange",function(){h(e);let o=d();return g(o.applyFilters())}),a()(),r(18,"div",26)(19,"label",27),c(20,"Mode de paiement"),a(),r(21,"p-dropdown",31),D("ngModelChange",function(o){h(e);let l=d();return L(l.selectedPaymentMethod,o)||(l.selectedPaymentMethod=o),g(o)}),_("onChange",function(){h(e);let o=d();return g(o.applyFilters())}),a()()(),r(22,"div",32)(23,"div",33)(24,"span",34),c(25,"Filtrer par p\xE9riode"),a()(),r(26,"div",35)(27,"div",36)(28,"label",27),c(29,"Type de p\xE9riode"),a(),r(30,"p-dropdown",37),D("ngModelChange",function(o){h(e);let l=d();return L(l.selectedPeriodType,o)||(l.selectedPeriodType=o),g(o)}),_("onChange",function(){h(e);let o=d();return g(o.onPeriodTypeChange())}),a()(),u(31,di,4,2,"div",38)(32,ci,9,6,"div",39)(33,ui,4,3,"div",38)(34,mi,4,3,"div",38),a()(),r(35,"div",32)(36,"div",33)(37,"span",34),c(38,"Filtrer par Montant"),a()(),u(39,hi,8,2,"div",40),a(),r(40,"div",4)(41,"div",5)(42,"p-button",41),_("onClick",function(){h(e);let o=d();return g(o.resetAllFilters())}),a()()()()}if(n&2){let e=d();s(3),R("ngModel",e.searchTerm),s(6),R("ngModel",e.selectedCategory),p("options",e.categoryOptions)("showClear",!0),s(4),R("ngModel",e.selectedSupplier),p("options",e.supplierOptions)("showClear",!0),s(4),R("ngModel",e.selectedStatus),p("options",e.statusOptions)("showClear",!0),s(4),R("ngModel",e.selectedPaymentMethod),p("options",e.paymentMethodOptions)("showClear",!0),s(9),R("ngModel",e.selectedPeriodType),p("options",e.periodTypeOptions)("showClear",!0),s(),p("ngIf",e.selectedPeriodType==="day"),s(),p("ngIf",e.selectedPeriodType==="month"),s(),p("ngIf",e.selectedPeriodType==="year"),s(),p("ngIf",e.selectedPeriodType==="range"),s(5),p("ngIf",e.showFilters),s(3),p("outlined",!0)}}function _i(n,t){n&1&&(r(0,"th",58),f(1,"p-tableHeaderCheckbox"),a())}function fi(n,t){n&1&&(r(0,"th",71),c(1,"Actions"),a())}function xi(n,t){if(n&1&&(r(0,"tr"),u(1,_i,2,0,"th",57),r(2,"th",58),c(3,"#"),a(),r(4,"th",59),c(5," Num\xE9ro "),f(6,"p-sortIcon",60),a(),r(7,"th",61),c(8,"Titre"),a(),r(9,"th",62),c(10,"Cat\xE9gorie"),a(),r(11,"th",63),c(12,"Fournisseur"),a(),r(13,"th",64),c(14," Date "),f(15,"p-sortIcon",65),a(),r(16,"th",66),c(17," Montant "),f(18,"p-sortIcon",67),a(),r(19,"th",62),c(20,"Mode paiement"),a(),r(21,"th",68),c(22," Statut "),f(23,"p-sortIcon",69),a(),u(24,fi,2,0,"th",70),a()),n&2){let e=d();s(),p("ngIf",e.selectionMode),s(23),p("ngIf",e.showActions)}}function vi(n,t){if(n&1&&(r(0,"td"),f(1,"p-tableCheckbox",80),a()),n&2){let e=d().$implicit;s(),p("value",e)}}function Ei(n,t){if(n&1&&(r(0,"div",16),c(1),ie(2,"slice"),a()),n&2){let e=d().$implicit;s(),ce(" ",Ot(2,2,e.description,0,50),"",e.description.length>50?"...":""," ")}}function bi(n,t){if(n&1&&(r(0,"div",74),c(1),a()),n&2){let e=d().$implicit;s(),I(e.fournisseurNom)}}function Ci(n,t){n&1&&(r(0,"div",81),c(1,"Non sp\xE9cifi\xE9"),a())}function yi(n,t){if(n&1&&(r(0,"div",16),c(1),a()),n&2){let e=d().$implicit,i=d();s(),T(" ",i.formatCurrency(e.montantEURO,i.Currency.EUR)," ")}}function Si(n,t){if(n&1){let e=E();r(0,"td")(1,"div",82)(2,"p-button",83),_("onClick",function(){h(e);let o=d().$implicit,l=d();return g(l.editExpense(o))}),a(),r(3,"p-button",84,1),_("onClick",function(o){h(e);let l=Tt(6);return g(l.toggle(o))}),a(),f(5,"p-menu",85,2),a()()}if(n&2){let e=d().$implicit,i=d();s(2),p("text",!0)("disabled",!i.canEditExpense(e)),s(),p("text",!0),s(2),p("model",i.getMenuItems(e))("popup",!0)("baseZIndex",9999)("autoZIndex",!1)}}function wi(n,t){if(n&1&&(r(0,"tr"),u(1,vi,2,1,"td",72),r(2,"td"),c(3),a(),r(4,"td")(5,"div",73),c(6),a(),r(7,"div",16),c(8),ie(9,"date"),a()(),r(10,"td")(11,"div",74),c(12),a(),u(13,Ei,3,6,"div",75),a(),r(14,"td")(15,"div",52)(16,"span",74),c(17),a()()(),r(18,"td"),u(19,bi,2,1,"div",76)(20,Ci,2,0,"div",77),a(),r(21,"td"),c(22),ie(23,"date"),a(),r(24,"td")(25,"div",78),c(26),a(),u(27,yi,2,1,"div",75),a(),r(28,"td")(29,"div",55),c(30),a()(),r(31,"td"),f(32,"p-tag",79),a(),u(33,Si,7,7,"td",72),a()),n&2){let e=t.$implicit,i=t.rowIndex,o=d();s(),p("ngIf",o.selectionMode),s(2),I(o.getDisplayIndex(i)),s(3),I(e.numero),s(2),I(ue(9,16,e.dateDepense,"dd/MM/yyyy")),s(4),I(e.titre),s(),p("ngIf",e.description),s(4),I(e.categorieNom),s(2),p("ngIf",e.fournisseurNom),s(),p("ngIf",!e.fournisseurNom),s(2),I(ue(23,19,e.dateDepense,"dd/MM/yyyy")),s(4),I(o.formatCurrency(e.montantXOF,e.devise)),s(),p("ngIf",e.montantEURO&&e.devise===o.Currency.XOF),s(3),I(e.paymentMethodNom),s(2),p("value",o.getStatusLabel(e.statut))("severity",o.getStatusSeverity(e.statut)),s(),p("ngIf",o.showActions)}}function Ti(n,t){n&1&&(r(0,"div",86),f(1,"p-progressSpinner"),a())}function Mi(n,t){if(n&1&&(r(0,"tr")(1,"td",87)(2,"div",88),f(3,"i",89),r(4,"span",90),c(5,"Aucune d\xE9pense trouv\xE9e"),a(),r(6,"span",81),c(7,"Ajustez vos filtres ou cr\xE9ez une nouvelle d\xE9pense"),a()()()()),n&2){let e=d();s(),x("colspan",e.selectionMode?e.showActions?11:10:e.showActions?10:9)}}function Fi(n,t){if(n&1){let e=E();r(0,"div",91)(1,"p-button",92),_("onClick",function(){h(e);let o=d();return g(o.approveSelectedExpenses())}),a(),r(2,"p-button",93),_("onClick",function(){h(e);let o=d();return g(o.rejectSelectedExpenses())}),a()()}}var rt=class n{showFilters=!0;showActions=!0;selectionMode=!1;onEdit=new w;onDelete=new w;onStatusChange=new w;onSelectionChange=new w;expenseService=v(Z);expenseCategoryService=v(et);expenseSupplierService=v(tt);paymentMethodService=v(nt);messageService=v(re);expenses=[];selectedExpenses=[];loading=!1;totalRecords=0;searchTerm="";searchSubject=new q;selectedCategory=null;selectedSupplier=null;selectedStatus=null;selectedPaymentMethod=null;selectedPeriodType=null;selectedDate=null;selectedMonth=null;selectedYear=null;dateRange=null;minAmount=null;maxAmount=null;amountFilterSubject=new q;currentPage=0;pageSize=20;first=0;categoryOptions=[];supplierOptions=[];statusOptions=[];paymentMethodOptions=[];periodTypeOptions=[{label:"Jour",value:"day"},{label:"Mois",value:"month"},{label:"Ann\xE9e",value:"year"},{label:"P\xE9riode",value:"range"}];monthOptions=[{label:"Janvier",value:1},{label:"F\xE9vrier",value:2},{label:"Mars",value:3},{label:"Avril",value:4},{label:"Mai",value:5},{label:"Juin",value:6},{label:"Juillet",value:7},{label:"Ao\xFBt",value:8},{label:"Septembre",value:9},{label:"Octobre",value:10},{label:"Novembre",value:11},{label:"D\xE9cembre",value:12}];yearOptions=[];destroy$=new q;ngOnInit(){this.initializeOptions(),this.setupSearchDebounce(),this.setupAmountFilterDebounce(),this.loadExpenses()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeOptions(){this.expenseCategoryService.getCategories().pipe(b(this.destroy$)).subscribe({next:t=>{this.categoryOptions=t.data.categories.map(e=>({label:e.nom,value:e.id}))},error:t=>{console.error("Erreur lors du chargement des cat\xE9gories",t)}}),this.expenseSupplierService.getSuppliers().pipe(b(this.destroy$)).subscribe({next:t=>{this.supplierOptions=t.data.suppliers.map(e=>({label:e.nom,value:e.id}))},error:t=>{console.error("Erreur lors du chargement des fournisseurs",t)}}),this.paymentMethodService.getPaymentMethods().pipe(b(this.destroy$)).subscribe({next:t=>{this.paymentMethodOptions=t.data.paymentMethods.map(e=>({label:e.nom,value:e.id}))},error:t=>{console.error("Erreur lors du chargement des modes de paiement",t)}}),this.statusOptions=Object.values(Pe).map(t=>({label:Q[t],value:t})),this.initializeYearOptions()}initializeYearOptions(){let t=new Date().getFullYear();this.yearOptions=[];for(let e=t-5;e<=t+2;e++)this.yearOptions.push({label:e.toString(),value:e})}setupSearchDebounce(){this.searchSubject.pipe(Se(300),gt(),b(this.destroy$)).subscribe(()=>{this.applyFilters()})}setupAmountFilterDebounce(){this.amountFilterSubject.pipe(Se(500),b(this.destroy$)).subscribe(()=>{this.applyFilters()})}onSearchInputChange(){this.searchSubject.next(this.searchTerm)}onAmountFilterChange(){this.amountFilterSubject.next()}applyFilters(){this.currentPage=0,this.first=0,this.loadExpenses()}onPeriodTypeChange(){this.selectedDate=null,this.selectedMonth=null,this.selectedYear=null,this.dateRange=null,this.applyFilters()}resetAllFilters(){this.searchTerm="",this.selectedCategory=null,this.selectedSupplier=null,this.selectedStatus=null,this.selectedPaymentMethod=null,this.selectedPeriodType=null,this.selectedDate=null,this.selectedMonth=null,this.selectedYear=null,this.dateRange=null,this.minAmount=null,this.maxAmount=null,this.currentPage=0,this.first=0,this.loadExpenses()}loadExpenses(){this.loading=!0;let t=this.buildFilter();this.expenseService.getExpenses(t).pipe(b(this.destroy$)).subscribe({next:e=>{this.expenses=e.expenses,this.totalRecords=e.total,this.loading=!1},error:e=>{console.error("Erreur lors du chargement des d\xE9penses",e),this.loading=!1,this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger les d\xE9penses"})}})}buildFilter(){let t={page:this.currentPage,size:this.pageSize};return this.searchTerm?.trim()&&(t.search=this.searchTerm.trim()),this.selectedCategory&&(t.categorieId=this.selectedCategory),this.selectedSupplier&&(t.fournisseurId=this.selectedSupplier),this.selectedStatus&&(t.statut=this.selectedStatus),this.selectedPaymentMethod&&(t.paymentMethodId=this.selectedPaymentMethod),this.minAmount&&(t.montantMin=this.minAmount),this.maxAmount&&(t.montantMax=this.maxAmount),this.applyDateFilters(t),t}applyDateFilters(t){if(this.selectedPeriodType)switch(this.selectedPeriodType){case"day":if(this.selectedDate){let e=new Date(this.selectedDate);e.setHours(0,0,0,0);let i=new Date(this.selectedDate);i.setHours(23,59,59,999),t.dateDebut=e,t.dateFin=i}break;case"month":if(this.selectedMonth&&(t.mois=this.selectedMonth),this.selectedYear&&(t.annee=this.selectedYear),this.selectedMonth&&this.selectedYear){let e=new Date(this.selectedYear,this.selectedMonth-1,1),i=new Date(this.selectedYear,this.selectedMonth,0,23,59,59,999);t.dateDebut=e,t.dateFin=i}break;case"year":if(this.selectedYear){t.annee=this.selectedYear;let e=new Date(this.selectedYear,0,1),i=new Date(this.selectedYear,11,31,23,59,59,999);t.dateDebut=e,t.dateFin=i}break;case"range":if(this.dateRange&&this.dateRange.length===2){let e=new Date(this.dateRange[0]);e.setHours(0,0,0,0);let i=new Date(this.dateRange[1]);i.setHours(23,59,59,999),t.dateDebut=e,t.dateFin=i}break}}onLazyLoadChange(t){this.currentPage=Math.floor(t.first/t.rows),this.pageSize=t.rows,this.first=t.first,this.loadExpenses()}editExpense(t){this.onEdit.emit(t)}deleteExpense(t){this.onDelete.emit(t)}changeStatus(t,e){this.onStatusChange.emit({expense:t,status:e})}duplicateExpense(t){let e=Re(le({},t),{id:0,numero:"",statut:"EN_ATTENTE",dateDepense:new Date,createdAt:new Date,updatedAt:new Date});this.onEdit.emit(e)}getMenuItems(t){let e=this.canEditExpense(t),i=this.canApproveExpense(t),o=this.canRejectExpense(t),l=this.canMarkAsPaid(t);return[{label:"Modifier",icon:"pi pi-pencil",disabled:!e,command:()=>this.editExpense(t)},{separator:!0},{label:"Approuver",icon:"pi pi-check",disabled:!i,command:()=>this.changeStatus(t,"APPROUVEE")},{label:"Marquer comme pay\xE9e",icon:"pi pi-dollar",disabled:!l,command:()=>this.changeStatus(t,"PAYEE")},{label:"Rejeter",icon:"pi pi-times",disabled:!o,command:()=>this.changeStatus(t,"REJETEE")},{separator:!0},{label:"Dupliquer",icon:"pi pi-copy",command:()=>this.duplicateExpense(t)},{separator:!0},{label:"Supprimer",icon:"pi pi-trash",styleClass:"text-red-500",disabled:!e,command:()=>this.deleteExpense(t)}]}onExpenseSelectionChange(t){this.selectedExpenses=t,this.onSelectionChange.emit(t)}approveSelectedExpenses(){if(this.selectedExpenses.length===0)return;let t=this.selectedExpenses.filter(e=>this.canApproveExpense(e));if(t.length===0){this.messageService.add({severity:"warn",summary:"Attention",detail:"Aucune d\xE9pense s\xE9lectionn\xE9e ne peut \xEAtre approuv\xE9e"});return}t.forEach(e=>{this.changeStatus(e,"APPROUVEE")}),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`${t.length} d\xE9pense(s) approuv\xE9e(s)`})}rejectSelectedExpenses(){if(this.selectedExpenses.length===0)return;let t=this.selectedExpenses.filter(e=>this.canRejectExpense(e));if(t.length===0){this.messageService.add({severity:"warn",summary:"Attention",detail:"Aucune d\xE9pense s\xE9lectionn\xE9e ne peut \xEAtre rejet\xE9e"});return}t.forEach(e=>{this.changeStatus(e,"REJETEE")}),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`${t.length} d\xE9pense(s) rejet\xE9e(s)`})}getDisplayIndex(t){return this.first+t+1}getDisplayRange(){if(this.totalRecords===0)return"0";let t=this.first+1,e=Math.min(this.first+this.pageSize,this.totalRecords);return`${t} \xE0 ${e}`}formatCurrency(t,e="XOF"){return e==="XOF"?new Intl.NumberFormat("fr-SN",{style:"currency",currency:"XOF",minimumFractionDigits:0}).format(t):new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR",minimumFractionDigits:2}).format(t)}getStatusLabel(t){return Q[t]}getStatusSeverity(t){return{EN_ATTENTE:"warn",APPROUVEE:"success",REJETEE:"danger",PAYEE:"info"}[t]||"secondary"}canEditExpense(t){return t.statut==="EN_ATTENTE"||t.statut==="REJETEE"}canApproveExpense(t){return t.statut==="EN_ATTENTE"}canRejectExpense(t){return t.statut==="EN_ATTENTE"||t.statut==="APPROUVEE"}canMarkAsPaid(t){return t.statut==="APPROUVEE"}exportToPdf(){let t=this.buildFilter();this.expenseService.exportToPdf(t).pipe(b(this.destroy$)).subscribe({next:e=>{let i=window.URL.createObjectURL(e),o=document.createElement("a");o.href=i,o.download=`depenses-${new Date().toISOString().split("T")[0]}.pdf`,o.click(),window.URL.revokeObjectURL(i),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Export PDF t\xE9l\xE9charg\xE9 avec succ\xE8s"})},error:e=>{console.error("Erreur lors de l'export PDF",e),this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible d'exporter en PDF"})}})}exportToExcel(){let t=this.buildFilter();this.expenseService.exportToExcel(t).pipe(b(this.destroy$)).subscribe({next:e=>{let i=window.URL.createObjectURL(e),o=document.createElement("a");o.href=i,o.download=`depenses-${new Date().toISOString().split("T")[0]}.xlsx`,o.click(),window.URL.revokeObjectURL(i),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:"Export Excel t\xE9l\xE9charg\xE9 avec succ\xE8s"})},error:e=>{console.error("Erreur lors de l'export Excel",e),this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible d'exporter en Excel"})}})}Currency=Ce;toggleFilters(){this.showFilters=!this.showFilters}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=P({type:n,selectors:[["app-expense-list"]],inputs:{showFilters:"showFilters",showActions:"showActions",selectionMode:"selectionMode"},outputs:{onEdit:"onEdit",onDelete:"onDelete",onStatusChange:"onStatusChange",onSelectionChange:"onSelectionChange"},decls:17,vars:21,consts:[["dt",""],["menuButton",""],["menu",""],[1,"expense-list","mb-5"],[1,"filters-actions"],[1,"export-actions"],["label","Recherche et Filtres","severity","warn",3,"onClick","icon","outlined"],["class","export-actions",4,"ngIf"],["class","filters-container my-4",4,"ngIf"],[1,"expense-list","filters-container"],["responsiveLayout","scroll","styleClass","p-datatable-sm",3,"onLazyLoad","selectionChange","value","loading","lazy","paginator","rows","totalRecords","rowsPerPageOptions","sortField","sortOrder","selection","selectionMode","first"],["pTemplate","header"],["pTemplate","body"],["pTemplate","loading"],["pTemplate","emptymessage"],[1,"flex","justify-content-between","align-items-center","mt-3"],[1,"text-sm","text-color-secondary"],["class","flex gap-2",4,"ngIf"],["icon","pi pi-file-pdf","label","Exporter en PDF","severity","danger","pTooltip","Exporter en PDF",3,"onClick","outlined"],["icon","pi pi-file-excel","label","Exporter en Excel","severity","success","pTooltip","Exporter en Excel",3,"onClick","outlined"],[1,"filters-container","my-4"],[1,"search-bar","mb-3"],["iconPosition","right"],["pInputText","","type","text","placeholder","Rechercher par titre, num\xE9ro ou description...",1,"w-full",3,"ngModelChange","input","ngModel"],[1,"pi","pi-search"],[1,"filters-grid","mb-3"],[1,"filter-group"],[1,"filter-label"],["placeholder","Toutes les cat\xE9gories","optionLabel","label","optionValue","value",1,"w-full",3,"ngModelChange","onChange","ngModel","options","showClear"],["placeholder","Tous les fournisseurs","optionLabel","label","optionValue","value",1,"w-full",3,"ngModelChange","onChange","ngModel","options","showClear"],["placeholder","Tous les statuts","optionLabel","label","optionValue","value",1,"w-full",3,"ngModelChange","onChange","ngModel","options","showClear"],["placeholder","Mode de paiement","optionLabel","label","optionValue","value",1,"w-full",3,"ngModelChange","onChange","ngModel","options","showClear"],[1,"period-filters","mb-3"],[1,"period-header"],[1,"filter-section-title"],[1,"period-controls"],[1,"period-type"],["placeholder","Filtrer par","optionLabel","label","optionValue","value",1,"w-full",3,"ngModelChange","onChange","ngModel","options","showClear"],["class","period-value",4,"ngIf"],["class","period-value month-year-selector",4,"ngIf"],["class","flex flex-wrap gap-3 mb-4",4,"ngIf"],["icon","pi pi-refresh","label","R\xE9initialiser tous les filtres","severity","info","pTooltip","R\xE9initialiser tous les filtres",3,"onClick","outlined"],[1,"period-value"],["dateFormat","dd/mm/yy","placeholder","S\xE9lectionner le jour",1,"w-full",3,"ngModelChange","onSelect","onClearClick","ngModel","showIcon"],[1,"period-value","month-year-selector"],[1,"month-selector"],["placeholder","Mois","optionLabel","label","optionValue","value",1,"w-full",3,"ngModelChange","onChange","ngModel","options","showClear"],[1,"year-selector"],["placeholder","Ann\xE9e","optionLabel","label","optionValue","value",1,"w-full",3,"ngModelChange","onChange","ngModel","options","showClear"],["placeholder","S\xE9lectionner l'ann\xE9e","optionLabel","label","optionValue","value",1,"w-full",3,"ngModelChange","onChange","ngModel","options","showClear"],["selectionMode","range","placeholder","S\xE9lectionner la p\xE9riode","dateFormat","dd/mm/yy",1,"w-full",3,"ngModelChange","onSelect","onClearClick","ngModel","readonlyInput","showIcon"],[1,"flex","flex-wrap","gap-3","mb-4"],[1,"flex","align-items-center","gap-2"],[1,"text-sm","font-medium"],["mode","currency","currency","XOF","locale","fr-SN","placeholder","Min",1,"w-8rem",3,"ngModelChange","onInput","ngModel"],[1,"text-sm"],["mode","currency","currency","XOF","locale","fr-SN","placeholder","Max",1,"w-8rem",3,"ngModelChange","onInput","ngModel"],["style","width: 3rem",4,"ngIf"],[2,"width","3rem"],["pSortableColumn","numero",2,"min-width","10rem"],["field","numero"],[2,"min-width","12rem"],[2,"min-width","8rem"],[2,"min-width","10rem"],["pSortableColumn","dateDepense",2,"min-width","8rem"],["field","dateDepense"],["pSortableColumn","montantXOF",2,"min-width","10rem"],["field","montantXOF"],["pSortableColumn","statut",2,"min-width","8rem"],["field","statut"],["style","width: 8rem",4,"ngIf"],[2,"width","8rem"],[4,"ngIf"],[1,"font-medium","text-primary"],[1,"font-medium"],["class","text-sm text-color-secondary",4,"ngIf"],["class","font-medium",4,"ngIf"],["class","text-color-secondary",4,"ngIf"],[1,"font-bold"],[3,"value","severity"],[3,"value"],[1,"text-color-secondary"],[1,"flex","gap-1"],["icon","pi pi-pencil","severity","warn","size","small","pTooltip","Modifier",3,"onClick","text","disabled"],["icon","pi pi-ellipsis-v","severity","secondary","size","small","pTooltip","Plus d'actions",3,"onClick","text"],["appendTo","body",3,"model","popup","baseZIndex","autoZIndex"],[1,"flex","align-items-center","justify-content-center","h-10rem"],[1,"text-center","p-4"],[1,"flex","flex-column","align-items-center"],[1,"pi","pi-inbox","text-4xl","text-color-secondary","mb-3"],[1,"text-lg"],[1,"flex","gap-2"],["icon","pi pi-check","label","Approuver la s\xE9lection","severity","success","size","small","pTooltip","Approuver les d\xE9penses s\xE9lectionn\xE9es",3,"onClick"],["icon","pi pi-times","label","Rejeter la s\xE9lection","severity","danger","size","small","pTooltip","Rejeter les d\xE9penses s\xE9lectionn\xE9es",3,"onClick"]],template:function(e,i){if(e&1){let o=E();r(0,"div",3)(1,"div",4)(2,"div",5)(3,"p-button",6),_("onClick",function(){return h(o),g(i.toggleFilters())}),a()(),u(4,pi,3,2,"div",7),a(),u(5,gi,43,22,"div",8),a(),r(6,"div",9)(7,"p-table",10,0),_("onLazyLoad",function(m){return h(o),g(i.onLazyLoadChange(m))}),D("selectionChange",function(m){return h(o),L(i.selectedExpenses,m)||(i.selectedExpenses=m),g(m)}),_("selectionChange",function(m){return h(o),g(i.onExpenseSelectionChange(m))}),u(9,xi,25,2,"ng-template",11)(10,wi,34,22,"ng-template",12)(11,Ti,2,0,"ng-template",13)(12,Mi,8,1,"ng-template",14),a(),r(13,"div",15)(14,"div",16),c(15),a(),u(16,Fi,3,0,"div",17),a()()}e&2&&(s(3),yt("icon","pi ",i.showFilters?"pi-filter-slash":"pi-filter"," "),p("outlined",!0),s(),p("ngIf",i.showActions),s(),p("ngIf",i.showFilters),s(2),p("value",i.expenses)("loading",i.loading)("lazy",!0)("paginator",!0)("rows",i.pageSize)("totalRecords",i.totalRecords)("rowsPerPageOptions",Mt(20,li))("sortField","dateDepense")("sortOrder",-1),R("selection",i.selectedExpenses),p("selectionMode",i.selectionMode?"multiple":null)("first",i.first),s(8),ce(" Affichage de ",i.getDisplayRange()," sur ",i.totalRecords," d\xE9penses "),s(),p("ngIf",i.selectionMode&&i.selectedExpenses.length>0))},dependencies:[U,k,Rt,Ne,dn,Xe,Qe,on,vn,hn,J,gn,_n,fn,xn,Ee,ve,Ze,Ke,ot,it,Ye,We,Je,Ge,qe,Ht,qt,jt,je,$t,Yt,Wt,He,un,mn],styles:['.filters-container[_ngcontent-%COMP%]{background:#f8fafc;border:1px solid #e2e8f0;border-radius:12px;padding:1.5rem;margin-bottom:1rem}.search-bar[_ngcontent-%COMP%]{margin-bottom:1rem}.filters-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:1rem}.filter-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.filter-label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#374151;margin-bottom:.25rem}.filter-section-title[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:#1f2937;display:flex;align-items:center;margin-bottom:.75rem}.filter-section-title[_ngcontent-%COMP%]:before{content:"";width:3px;height:16px;background:#3b82f6;margin-right:.5rem;border-radius:2px}.period-filters[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:8px;padding:1rem}.period-controls[_ngcontent-%COMP%]{display:grid;grid-template-columns:200px 1fr;gap:1rem;align-items:start}.period-type[_ngcontent-%COMP%], .period-value[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.month-year-selector[_ngcontent-%COMP%]{display:grid!important;grid-template-columns:1fr 1fr;gap:1rem}.month-selector[_ngcontent-%COMP%], .year-selector[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.filters-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem;margin-top:1rem;padding-top:1rem}.reset-actions[_ngcontent-%COMP%]{flex:1}.export-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}@media (max-width: 768px){.filters-grid[_ngcontent-%COMP%], .period-controls[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:.75rem}.month-year-selector[_ngcontent-%COMP%]{grid-template-columns:1fr!important}.filters-actions[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.reset-actions[_ngcontent-%COMP%], .export-actions[_ngcontent-%COMP%]{flex:none;display:flex;justify-content:center}.export-actions[_ngcontent-%COMP%]{gap:.75rem}.filters-container[_ngcontent-%COMP%]{padding:1rem}}@media (max-width: 480px){.export-actions[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}.export-actions[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]{width:100%;justify-content:center}}']})};var Ii=["file"],Oi=["header"],Pn=["content"],Pi=["toolbar"],Ri=["chooseicon"],Li=["filelabel"],Di=["uploadicon"],Ui=["cancelicon"],Ai=["empty"],Vi=["advancedfileinput"],zi=["basicfileinput"],ki=(n,t,e,i,o)=>({$implicit:n,uploadedFiles:t,chooseCallback:e,clearCallback:i,uploadCallback:o}),Ni=(n,t,e,i,o,l,m,$)=>({$implicit:n,uploadedFiles:t,chooseCallback:e,clearCallback:i,removeUploadedFileCallback:o,removeFileCallback:l,progress:m,messages:$}),Bi=n=>({$implicit:n});function $i(n,t){if(n&1&&f(0,"span"),n&2){let e=d(3);V(e.chooseIcon),x("aria-label",!0)("data-pc-section","chooseicon")}}function ji(n,t){n&1&&f(0,"PlusIcon"),n&2&&x("aria-label",!0)("data-pc-section","chooseicon")}function qi(n,t){}function Xi(n,t){n&1&&u(0,qi,0,0,"ng-template")}function Qi(n,t){if(n&1&&(r(0,"span"),u(1,Xi,1,0,null,11),a()),n&2){let e=d(4);x("aria-label",!0)("data-pc-section","chooseicon"),s(),p("ngTemplateOutlet",e.chooseIconTemplate||e._chooseIconTemplate)}}function Hi(n,t){if(n&1&&(te(0),u(1,ji,1,2,"PlusIcon",9)(2,Qi,2,3,"span",9),ne()),n&2){let e=d(3);s(),p("ngIf",!e.chooseIconTemplate&&!e._chooseIconTemplate),s(),p("ngIf",e.chooseIconTemplate||e._chooseIconTemplate)}}function Wi(n,t){if(n&1&&f(0,"span",21),n&2){let e=d(4);p("ngClass",e.uploadIcon),x("aria-hidden",!0)}}function Yi(n,t){n&1&&f(0,"UploadIcon")}function Gi(n,t){}function Ji(n,t){n&1&&u(0,Gi,0,0,"ng-template")}function Ki(n,t){if(n&1&&(r(0,"span"),u(1,Ji,1,0,null,11),a()),n&2){let e=d(5);x("aria-hidden",!0),s(),p("ngTemplateOutlet",e.uploadIconTemplate||e._uploadIconTemplate)}}function Zi(n,t){if(n&1&&(te(0),u(1,Yi,1,0,"UploadIcon",9)(2,Ki,2,2,"span",9),ne()),n&2){let e=d(4);s(),p("ngIf",!e.uploadIconTemplate&&!e._uploadIconTemplate),s(),p("ngIf",e.uploadIconTemplate||e._uploadIconTemplate)}}function eo(n,t){if(n&1){let e=E();r(0,"p-button",19),_("onClick",function(){h(e);let o=d(3);return g(o.upload())}),u(1,Wi,1,2,"span",20)(2,Zi,3,2,"ng-container",9),a()}if(n&2){let e=d(3);p("label",e.uploadButtonLabel)("disabled",!e.hasFiles()||e.isFileLimitExceeded())("styleClass","p-fileupload-upload-button "+e.uploadStyleClass)("buttonProps",e.uploadButtonProps),s(),p("ngIf",e.uploadIcon),s(),p("ngIf",!e.uploadIcon)}}function to(n,t){if(n&1&&f(0,"span",21),n&2){let e=d(4);p("ngClass",e.cancelIcon)}}function no(n,t){n&1&&f(0,"TimesIcon"),n&2&&x("aria-hidden",!0)}function io(n,t){}function oo(n,t){n&1&&u(0,io,0,0,"ng-template")}function ro(n,t){if(n&1&&(r(0,"span"),u(1,oo,1,0,null,11),a()),n&2){let e=d(5);x("aria-hidden",!0),s(),p("ngTemplateOutlet",e.cancelIconTemplate||e._cancelIconTemplate)}}function ao(n,t){if(n&1&&(te(0),u(1,no,1,1,"TimesIcon",9)(2,ro,2,2,"span",9),ne()),n&2){let e=d(4);s(),p("ngIf",!e.cancelIconTemplate&&!e._cancelIconTemplate),s(),p("ngIf",e.cancelIconTemplate||e._cancelIconTemplate)}}function so(n,t){if(n&1){let e=E();r(0,"p-button",19),_("onClick",function(){h(e);let o=d(3);return g(o.clear())}),u(1,to,1,1,"span",20)(2,ao,3,2,"ng-container",9),a()}if(n&2){let e=d(3);p("label",e.cancelButtonLabel)("disabled",!e.hasFiles()||e.uploading)("styleClass","p-fileupload-cancel-button "+e.cancelStyleClass)("buttonProps",e.cancelButtonProps),s(),p("ngIf",e.cancelIcon),s(),p("ngIf",!e.cancelIcon)}}function lo(n,t){if(n&1){let e=E();te(0),r(1,"p-button",16),_("focus",function(){h(e);let o=d(2);return g(o.onFocus())})("blur",function(){h(e);let o=d(2);return g(o.onBlur())})("onClick",function(){h(e);let o=d(2);return g(o.choose())})("keydown.enter",function(){h(e);let o=d(2);return g(o.choose())}),r(2,"input",7,0),_("change",function(o){h(e);let l=d(2);return g(l.onFileSelect(o))}),a(),u(4,$i,1,4,"span",17)(5,Hi,3,2,"ng-container",9),a(),u(6,eo,3,6,"p-button",18)(7,so,3,6,"p-button",18),ne()}if(n&2){let e=d(2);s(),p("styleClass","p-fileupload-choose-button "+e.chooseStyleClass)("disabled",e.disabled||e.isChooseDisabled())("label",e.chooseButtonLabel)("buttonProps",e.chooseButtonProps),x("data-pc-section","choosebutton"),s(),p("multiple",e.multiple)("accept",e.accept)("disabled",e.disabled||e.isChooseDisabled()),x("aria-label",e.browseFilesLabel)("title","")("data-pc-section","input"),s(2),p("ngIf",e.chooseIcon),s(),p("ngIf",!e.chooseIcon),s(),p("ngIf",!e.auto&&e.showUploadButton),s(),p("ngIf",!e.auto&&e.showCancelButton)}}function po(n,t){n&1&&z(0)}function co(n,t){n&1&&z(0)}function uo(n,t){if(n&1&&f(0,"p-progressbar",22),n&2){let e=d(2);p("value",e.progress)("showValue",!1)}}function mo(n,t){if(n&1&&f(0,"p-message",14),n&2){let e=t.$implicit;p("severity",e.severity)("text",e.text)}}function ho(n,t){if(n&1){let e=E();r(0,"img",33),_("error",function(o){h(e);let l=d(5);return g(l.imageError(o))}),a()}if(n&2){let e=d().$implicit,i=d(4);p("src",e.objectURL,Et)("width",i.previewWidth)}}function go(n,t){n&1&&f(0,"TimesIcon")}function _o(n,t){}function fo(n,t){n&1&&u(0,_o,0,0,"ng-template")}function xo(n,t){if(n&1&&u(0,go,1,0,"TimesIcon",9)(1,fo,1,0,null,11),n&2){let e=d(5);p("ngIf",!e.cancelIconTemplate&&!e._cancelIconTemplate),s(),p("ngTemplateOutlet",e.cancelIconTemplate||e._cancelIconTemplate)}}function vo(n,t){if(n&1){let e=E();r(0,"div",24),u(1,ho,1,2,"img",27),r(2,"div",28)(3,"div",29),c(4),a(),r(5,"span",30),c(6),a()(),r(7,"div",31)(8,"p-button",32),_("onClick",function(o){let l=h(e).index,m=d(4);return g(m.remove(o,l))}),u(9,xo,2,2,"ng-template",null,2,ct),a()()()}if(n&2){let e=t.$implicit,i=d(4);s(),p("ngIf",i.isImage(e)),s(3),I(e.name),s(2),I(i.formatSize(e.size)),s(2),p("disabled",i.uploading)("styleClass","p-fileupload-file-remove-button "+i.removeStyleClass)}}function Eo(n,t){if(n&1&&u(0,vo,11,5,"div",26),n&2){let e=d(3);p("ngForOf",e.files)}}function bo(n,t){}function Co(n,t){if(n&1&&u(0,bo,0,0,"ng-template",25),n&2){let e=d(3);p("ngForOf",e.files)("ngForTemplate",e.fileTemplate||e._fileTemplate)}}function yo(n,t){if(n&1&&(r(0,"div",23),u(1,Eo,1,1,"div",24)(2,Co,1,2,null,25),a()),n&2){let e=d(2);s(),ee(!e.fileTemplate&&!e._fileTemplate?1:-1),s(),ee(e.fileTemplate||e._fileTemplate?2:-1)}}function So(n,t){n&1&&z(0)}function wo(n,t){n&1&&z(0)}function To(n,t){if(n&1&&u(0,wo,1,0,"ng-container",11),n&2){let e=d(2);p("ngTemplateOutlet",e.emptyTemplate||e._emptyTemplate)}}function Mo(n,t){if(n&1){let e=E();r(0,"div",6)(1,"input",7,0),_("change",function(o){h(e);let l=d();return g(l.onFileSelect(o))}),a(),r(3,"div",8),u(4,lo,8,15,"ng-container",9)(5,po,1,0,"ng-container",10)(6,co,1,0,"ng-container",11),a(),r(7,"div",12,1),_("dragenter",function(o){h(e);let l=d();return g(l.onDragEnter(o))})("dragleave",function(o){h(e);let l=d();return g(l.onDragLeave(o))})("drop",function(o){h(e);let l=d();return g(l.onDrop(o))}),u(9,uo,1,2,"p-progressbar",13),pt(10,mo,1,2,"p-message",14,lt),u(12,yo,3,2,"div",15)(13,So,1,0,"ng-container",10)(14,To,1,1,"ng-container"),a()()}if(n&2){let e=d();V(e.styleClass),p("ngClass","p-fileupload p-fileupload-advanced p-component")("ngStyle",e.style),x("data-pc-name","fileupload")("data-pc-section","root"),s(),Ct("display","none"),p("multiple",e.multiple)("accept",e.accept)("disabled",e.disabled||e.isChooseDisabled()),x("aria-label",e.browseFilesLabel)("title","")("data-pc-section","input"),s(3),p("ngIf",!e.headerTemplate&&!e._headerTemplate),s(),p("ngTemplateOutlet",e.headerTemplate||e._headerTemplate)("ngTemplateOutletContext",Ft(24,ki,e.files,e.uploadedFiles,e.choose.bind(e),e.clear.bind(e),e.upload.bind(e))),s(),p("ngTemplateOutlet",e.toolbarTemplate||e._toolbarTemplate),s(),x("data-pc-section","content"),s(2),p("ngIf",e.hasFiles()),s(),dt(e.msgs),s(2),p("ngIf",e.hasFiles()),s(),p("ngTemplateOutlet",e.contentTemplate||e._contentTemplate)("ngTemplateOutletContext",It(30,Ni,e.files,e.uploadedFiles,e.choose.bind(e),e.clear.bind(e),e.removeUploadedFile.bind(e),e.remove.bind(e),e.progress,e.msgs)),s(),ee((e.emptyTemplate||e._emptyTemplate)&&!e.hasFiles()&&!e.hasUploadedFiles()?14:-1)}}function Fo(n,t){if(n&1&&f(0,"p-message",14),n&2){let e=t.$implicit;p("severity",e.severity)("text",e.text)}}function Io(n,t){if(n&1&&f(0,"span",37),n&2){let e=d(4);p("ngClass",e.uploadIcon)}}function Oo(n,t){n&1&&f(0,"UploadIcon",40),n&2&&p("styleClass","p-button-icon p-button-icon-left")}function Po(n,t){}function Ro(n,t){n&1&&u(0,Po,0,0,"ng-template")}function Lo(n,t){if(n&1&&(r(0,"span",41),u(1,Ro,1,0,null,11),a()),n&2){let e=d(5);s(),p("ngTemplateOutlet",e._uploadIconTemplate||e.uploadIconTemplate)}}function Do(n,t){if(n&1&&(te(0),u(1,Oo,1,1,"UploadIcon",38)(2,Lo,2,1,"span",39),ne()),n&2){let e=d(4);s(),p("ngIf",!e.uploadIconTemplate&&!e._uploadIconTemplate),s(),p("ngIf",e._uploadIconTemplate||e.uploadIconTemplate)}}function Uo(n,t){if(n&1&&u(0,Io,1,1,"span",36)(1,Do,3,2,"ng-container",9),n&2){let e=d(3);p("ngIf",e.uploadIcon),s(),p("ngIf",!e.uploadIcon)}}function Ao(n,t){if(n&1&&f(0,"span",43),n&2){let e=d(4);p("ngClass",e.chooseIcon)}}function Vo(n,t){n&1&&f(0,"PlusIcon"),n&2&&x("data-pc-section","uploadicon")}function zo(n,t){}function ko(n,t){n&1&&u(0,zo,0,0,"ng-template")}function No(n,t){if(n&1&&(te(0),u(1,Vo,1,1,"PlusIcon",9)(2,ko,1,0,null,11),ne()),n&2){let e=d(4);s(),p("ngIf",!e.chooseIconTemplate&&!e._chooseIconTemplate),s(),p("ngTemplateOutlet",e.chooseIconTemplate||e._chooseIconTemplate)}}function Bo(n,t){if(n&1&&u(0,Ao,1,1,"span",42)(1,No,3,2,"ng-container",9),n&2){let e=d(3);p("ngIf",e.chooseIcon),s(),p("ngIf",!e.chooseIcon)}}function $o(n,t){if(n&1&&u(0,Uo,2,2)(1,Bo,2,2),n&2){let e=d(2);ee(e.hasFiles()&&!e.auto?0:1)}}function jo(n,t){if(n&1&&(r(0,"span"),c(1),a()),n&2){let e=d(3);V(e.cx("filelabel")),s(),T(" ",e.basicFileChosenLabel()," ")}}function qo(n,t){n&1&&z(0)}function Xo(n,t){if(n&1&&u(0,qo,1,0,"ng-container",10),n&2){let e=d(3);p("ngTemplateOutlet",e.fileLabelTemplate||e._fileLabelTemplate)("ngTemplateOutletContext",ze(2,Bi,e.files))}}function Qo(n,t){if(n&1&&u(0,jo,2,3,"span",44)(1,Xo,1,4,"ng-container"),n&2){let e=d(2);ee(!e.fileLabelTemplate&&!e._fileLabelTemplate?0:1)}}function Ho(n,t){if(n&1){let e=E();r(0,"div",21),pt(1,Fo,1,2,"p-message",14,lt),r(3,"p-button",34),_("onClick",function(){h(e);let o=d();return g(o.onBasicUploaderClick())})("keydown",function(o){h(e);let l=d();return g(l.onBasicKeydown(o))}),u(4,$o,2,1,"ng-template",null,2,ct),r(6,"input",35,3),_("change",function(o){h(e);let l=d();return g(l.onFileSelect(o))})("focus",function(){h(e);let o=d();return g(o.onFocus())})("blur",function(){h(e);let o=d();return g(o.onBlur())}),a()(),u(8,Qo,2,1),a()}if(n&2){let e=d();V(e.styleClass),p("ngClass","p-fileupload p-fileupload-basic p-component"),x("data-pc-name","fileupload"),s(),dt(e.msgs),s(2),Ue(e.style),p("styleClass","p-fileupload-choose-button "+e.chooseStyleClass)("disabled",e.disabled)("label",e.chooseButtonLabel)("buttonProps",e.chooseButtonProps),s(3),p("accept",e.accept)("multiple",e.multiple)("disabled",e.disabled),x("aria-label",e.browseFilesLabel)("data-pc-section","input"),s(2),ee(e.auto?-1:8)}}var Wo=({dt:n})=>`
.p-fileupload input[type="file"] {
    display: none;
}

.p-fileupload-advanced {
    border: 1px solid ${n("fileupload.border.color")};
    border-radius: ${n("fileupload.border.radius")};
    background: ${n("fileupload.background")};
    color: ${n("fileupload.color")};
}

.p-fileupload-header {
    display: flex;
    align-items: center;
    padding: ${n("fileupload.header.padding")};
    background: ${n("fileupload.header.background")};
    color: ${n("fileupload.header.color")};
    border-style: solid;
    border-width: ${n("fileupload.header.border.width")};
    border-color: ${n("fileupload.header.border.color")};
    border-radius: ${n("fileupload.header.border.radius")};
    gap: ${n("fileupload.header.gap")};
}

.p-fileupload-content {
    border: 1px solid transparent;
    display: flex;
    flex-direction: column;
    gap: ${n("fileupload.content.gap")};
    transition: border-color ${n("fileupload.transition.duration")};
    padding: ${n("fileupload.content.padding")};
}

.p-fileupload-content .p-progressbar {
    width: 100%;
    height: ${n("fileupload.progressbar.height")};
}

.p-fileupload-file-list {
    display: flex;
    flex-direction: column;
    gap: ${n("fileupload.filelist.gap")};
}

.p-fileupload-file {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    padding: ${n("fileupload.file.padding")};
    border-bottom: 1px solid ${n("fileupload.file.border.color")};
    gap: ${n("fileupload.file.gap")};
}

.p-fileupload-file:last-child {
    border-bottom: 0;
}

.p-fileupload-file-info {
    display: flex;
    flex-direction: column;
    gap: ${n("fileupload.file.info.gap")};
}

.p-fileupload-file-thumbnail {
    flex-shrink: 0;
}

.p-fileupload-file-actions {
    margin-left: auto;
}

.p-fileupload-highlight {
    border: 1px dashed ${n("fileupload.content.highlight.border.color")};
}

.p-fileupload-advanced .p-message {
    margin-top: 0;
}

.p-fileupload-basic {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    justify-content: center;
    gap: ${n("fileupload.basic.gap")};
}
`,Yo={root:({instance:n})=>`p-fileupload p-fileupload-${n.mode} p-component`,header:"p-fileupload-header",pcChooseButton:"p-fileupload-choose-button",pcUploadButton:"p-fileupload-upload-button",pcCancelButton:"p-fileupload-cancel-button",content:"p-fileupload-content",fileList:"p-fileupload-file-list",file:"p-fileupload-file",fileThumbnail:"p-fileupload-file-thumbnail",fileInfo:"p-fileupload-file-info",fileName:"p-fileupload-file-name",fileSize:"p-fileupload-file-size",pcFileBadge:"p-fileupload-file-badge",fileActions:"p-fileupload-file-actions",pcFileRemoveButton:"p-fileupload-file-remove-button"},Rn=(()=>{class n extends xe{name="fileupload";theme=Wo;classes=Yo;static \u0275fac=(()=>{let e;return function(o){return(e||(e=A(n)))(o||n)}})();static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})();var Go=(()=>{class n extends ae{name;url;method="post";multiple;accept;disabled;auto;withCredentials;maxFileSize;invalidFileSizeMessageSummary="{0}: Invalid file size, ";invalidFileSizeMessageDetail="maximum upload size is {0}.";invalidFileTypeMessageSummary="{0}: Invalid file type, ";invalidFileTypeMessageDetail="allowed file types: {0}.";invalidFileLimitMessageDetail="limit is {0} at most.";invalidFileLimitMessageSummary="Maximum number of files exceeded, ";style;styleClass;previewWidth=50;chooseLabel;uploadLabel;cancelLabel;chooseIcon;uploadIcon;cancelIcon;showUploadButton=!0;showCancelButton=!0;mode="advanced";headers;customUpload;fileLimit;uploadStyleClass;cancelStyleClass;removeStyleClass;chooseStyleClass;chooseButtonProps;uploadButtonProps={severity:"secondary"};cancelButtonProps={severity:"secondary"};onBeforeUpload=new w;onSend=new w;onUpload=new w;onError=new w;onClear=new w;onRemove=new w;onSelect=new w;onProgress=new w;uploadHandler=new w;onImageError=new w;onRemoveUploadedFile=new w;fileTemplate;headerTemplate;contentTemplate;toolbarTemplate;chooseIconTemplate;fileLabelTemplate;uploadIconTemplate;cancelIconTemplate;emptyTemplate;advancedFileInput;basicFileInput;content;set files(e){this._files=[];for(let i=0;i<e.length;i++){let o=e[i];this.validate(o)&&(this.isImage(o)&&(o.objectURL=this.sanitizer.bypassSecurityTrustUrl(window.URL.createObjectURL(e[i]))),this._files.push(e[i]))}}get files(){return this._files}get basicButtonLabel(){return this.auto||!this.hasFiles()?this.chooseLabel:this.uploadLabel??this.files[0].name}_files=[];progress=0;dragHighlight;msgs;uploadedFileCount=0;focus;uploading;duplicateIEEvent;translationSubscription;dragOverListener;uploadedFiles=[];sanitizer=v(Lt);zone=v(vt);http=v($e);_componentStyle=v(Rn);ngOnInit(){super.ngOnInit(),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.cd.markForCheck()})}ngAfterViewInit(){super.ngAfterViewInit(),_e(this.platformId)&&this.mode==="advanced"&&this.zone.runOutsideAngular(()=>{this.content&&(this.dragOverListener=this.renderer.listen(this.content.nativeElement,"dragover",this.onDragOver.bind(this)))})}_headerTemplate;_contentTemplate;_toolbarTemplate;_chooseIconTemplate;_uploadIconTemplate;_cancelIconTemplate;_emptyTemplate;_fileTemplate;_fileLabelTemplate;templates;ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"header":this._headerTemplate=e.template;break;case"file":this._fileTemplate=e.template;break;case"content":this._contentTemplate=e.template;break;case"toolbar":this._toolbarTemplate=e.template;break;case"chooseicon":this._chooseIconTemplate=e.template;break;case"uploadicon":this._uploadIconTemplate=e.template;break;case"cancelicon":this._cancelIconTemplate=e.template;break;case"empty":this._emptyTemplate=e.template;break;case"filelabel":this._fileLabelTemplate=e.template;break;default:this._fileTemplate=e.template;break}})}basicFileChosenLabel(){return this.auto?this.chooseButtonLabel:this.hasFiles()?this.files&&this.files.length===1?this.files[0].name:this.config.getTranslation("fileChosenMessage")?.replace("{0}",this.files.length):this.config.getTranslation("noFileChosenMessage")||""}getTranslation(e){return this.config.getTranslation(e)}choose(){this.advancedFileInput?.nativeElement.click()}onFileSelect(e){if(e.type!=="drop"&&this.isIE11()&&this.duplicateIEEvent){this.duplicateIEEvent=!1;return}this.msgs=[],this.multiple||(this.files=[]);let i=e.dataTransfer?e.dataTransfer.files:e.target.files;for(let o=0;o<i.length;o++){let l=i[o];this.isFileSelected(l)||this.validate(l)&&(this.isImage(l)&&(l.objectURL=this.sanitizer.bypassSecurityTrustUrl(window.URL.createObjectURL(i[o]))),this.files.push(i[o]))}this.onSelect.emit({originalEvent:e,files:i,currentFiles:this.files}),this.checkFileLimit(i),this.hasFiles()&&this.auto&&(this.mode!=="advanced"||!this.isFileLimitExceeded())&&this.upload(),e.type!=="drop"&&this.isIE11()?this.clearIEInput():this.clearInputElement()}isFileSelected(e){for(let i of this.files)if(i.name+i.type+i.size===e.name+e.type+e.size)return!0;return!1}isIE11(){if(_e(this.platformId))return!!this.document.defaultView.MSInputMethodContext&&!!this.document.documentMode}validate(e){if(this.msgs=this.msgs||[],this.accept&&!this.isFileTypeValid(e)){let i=`${this.invalidFileTypeMessageSummary.replace("{0}",e.name)} ${this.invalidFileTypeMessageDetail.replace("{0}",this.accept)}`;return this.msgs.push({severity:"error",text:i}),!1}if(this.maxFileSize&&e.size>this.maxFileSize){let i=`${this.invalidFileSizeMessageSummary.replace("{0}",e.name)} ${this.invalidFileSizeMessageDetail.replace("{0}",this.formatSize(this.maxFileSize))}`;return this.msgs.push({severity:"error",text:i}),!1}return!0}isFileTypeValid(e){let i=this.accept?.split(",").map(o=>o.trim());for(let o of i)if(this.isWildcard(o)?this.getTypeClass(e.type)===this.getTypeClass(o):e.type==o||this.getFileExtension(e).toLowerCase()===o.toLowerCase())return!0;return!1}getTypeClass(e){return e.substring(0,e.indexOf("/"))}isWildcard(e){return e.indexOf("*")!==-1}getFileExtension(e){return"."+e.name.split(".").pop()}isImage(e){return/^image\//.test(e.type)}onImageLoad(e){window.URL.revokeObjectURL(e.src)}uploader(){if(this.customUpload)this.fileLimit&&(this.uploadedFileCount+=this.files.length),this.uploadHandler.emit({files:this.files}),this.cd.markForCheck();else{this.uploading=!0,this.msgs=[];let e=new FormData;this.onBeforeUpload.emit({formData:e});for(let i=0;i<this.files.length;i++)e.append(this.name,this.files[i],this.files[i].name);this.http.request(this.method,this.url,{body:e,headers:this.headers,reportProgress:!0,observe:"events",withCredentials:this.withCredentials}).subscribe(i=>{switch(i.type){case Be.Sent:this.onSend.emit({originalEvent:i,formData:e});break;case Be.Response:this.uploading=!1,this.progress=0,i.status>=200&&i.status<300?(this.fileLimit&&(this.uploadedFileCount+=this.files.length),this.onUpload.emit({originalEvent:i,files:this.files})):this.onError.emit({files:this.files}),this.uploadedFiles.push(...this.files),this.clear();break;case Be.UploadProgress:{i.loaded&&(this.progress=Math.round(i.loaded*100/i.total)),this.onProgress.emit({originalEvent:i,progress:this.progress});break}}this.cd.markForCheck()},i=>{this.uploading=!1,this.onError.emit({files:this.files,error:i})})}}clear(){this.files=[],this.uploadedFileCount=0,this.onClear.emit(),this.clearInputElement(),this.msgs=[],this.cd.markForCheck()}remove(e,i){this.clearInputElement(),this.onRemove.emit({originalEvent:e,file:this.files[i]}),this.files.splice(i,1),this.checkFileLimit(this.files)}removeUploadedFile(e){let i=this.uploadedFiles.splice(e,1)[0];this.uploadedFiles=[...this.uploadedFiles],this.onRemoveUploadedFile.emit({file:i,files:this.uploadedFiles})}isFileLimitExceeded(){let i=this.auto?this.files.length:this.files.length+this.uploadedFileCount;return this.fileLimit&&this.fileLimit<=i&&this.focus&&(this.focus=!1),this.fileLimit&&this.fileLimit<i}isChooseDisabled(){return this.auto?this.fileLimit&&this.fileLimit<=this.files.length:this.fileLimit&&this.fileLimit<=this.files.length+this.uploadedFileCount}checkFileLimit(e){this.msgs??=[];let i=this.msgs.length>0&&this.fileLimit&&this.fileLimit<e.length;if(this.isFileLimitExceeded()||i){let o=`${this.invalidFileLimitMessageSummary.replace("{0}",this.fileLimit.toString())} ${this.invalidFileLimitMessageDetail.replace("{0}",this.fileLimit.toString())}`;this.msgs.push({severity:"error",text:o})}else this.msgs=this.msgs.filter(o=>!o.text.includes(this.invalidFileLimitMessageSummary))}clearInputElement(){this.advancedFileInput&&this.advancedFileInput.nativeElement&&(this.advancedFileInput.nativeElement.value=""),this.basicFileInput&&this.basicFileInput.nativeElement&&(this.basicFileInput.nativeElement.value="")}clearIEInput(){this.advancedFileInput&&this.advancedFileInput.nativeElement&&(this.duplicateIEEvent=!0,this.advancedFileInput.nativeElement.value="")}hasFiles(){return this.files&&this.files.length>0}hasUploadedFiles(){return this.uploadedFiles&&this.uploadedFiles.length>0}onDragEnter(e){this.disabled||(e.stopPropagation(),e.preventDefault())}onDragOver(e){this.disabled||(Te(this.content?.nativeElement,"p-fileupload-highlight"),this.dragHighlight=!0,e.stopPropagation(),e.preventDefault())}onDragLeave(e){this.disabled||fe(this.content?.nativeElement,"p-fileupload-highlight")}onDrop(e){if(!this.disabled){fe(this.content?.nativeElement,"p-fileupload-highlight"),e.stopPropagation(),e.preventDefault();let i=e.dataTransfer?e.dataTransfer.files:e.target.files;(this.multiple||i&&i.length===1)&&this.onFileSelect(e)}}onFocus(){this.focus=!0}onBlur(){this.focus=!1}formatSize(e){let l=this.getTranslation(K.FILE_SIZE_TYPES);if(e===0)return`0 ${l[0]}`;let m=Math.floor(Math.log(e)/Math.log(1024));return`${(e/Math.pow(1024,m)).toFixed(3)} ${l[m]}`}upload(){this.hasFiles()&&this.uploader()}onBasicUploaderClick(){this.basicFileInput?.nativeElement.click()}onBasicKeydown(e){switch(e.code){case"Space":case"Enter":this.onBasicUploaderClick(),e.preventDefault();break}}imageError(e){this.onImageError.emit(e)}getBlockableElement(){return this.el.nativeElement.children[0]}get chooseButtonLabel(){return this.chooseLabel||this.config.getTranslation(K.CHOOSE)}get uploadButtonLabel(){return this.uploadLabel||this.config.getTranslation(K.UPLOAD)}get cancelButtonLabel(){return this.cancelLabel||this.config.getTranslation(K.CANCEL)}get browseFilesLabel(){return this.config.getTranslation(K.ARIA)[K.BROWSE_FILES]}get pendingLabel(){return this.config.getTranslation(K.PENDING)}ngOnDestroy(){this.content&&this.content.nativeElement&&this.dragOverListener&&(this.dragOverListener(),this.dragOverListener=null),this.translationSubscription&&this.translationSubscription.unsubscribe(),super.ngOnDestroy()}static \u0275fac=(()=>{let e;return function(o){return(e||(e=A(n)))(o||n)}})();static \u0275cmp=P({type:n,selectors:[["p-fileupload"],["p-fileUpload"]],contentQueries:function(i,o,l){if(i&1&&(F(l,Ii,4),F(l,Oi,4),F(l,Pn,4),F(l,Pi,4),F(l,Ri,4),F(l,Li,4),F(l,Di,4),F(l,Ui,4),F(l,Ai,4),F(l,J,4)),i&2){let m;C(m=y())&&(o.fileTemplate=m.first),C(m=y())&&(o.headerTemplate=m.first),C(m=y())&&(o.contentTemplate=m.first),C(m=y())&&(o.toolbarTemplate=m.first),C(m=y())&&(o.chooseIconTemplate=m.first),C(m=y())&&(o.fileLabelTemplate=m.first),C(m=y())&&(o.uploadIconTemplate=m.first),C(m=y())&&(o.cancelIconTemplate=m.first),C(m=y())&&(o.emptyTemplate=m.first),C(m=y())&&(o.templates=m)}},viewQuery:function(i,o){if(i&1&&(W(Vi,5),W(zi,5),W(Pn,5)),i&2){let l;C(l=y())&&(o.advancedFileInput=l.first),C(l=y())&&(o.basicFileInput=l.first),C(l=y())&&(o.content=l.first)}},inputs:{name:"name",url:"url",method:"method",multiple:[2,"multiple","multiple",G],accept:"accept",disabled:[2,"disabled","disabled",G],auto:[2,"auto","auto",G],withCredentials:[2,"withCredentials","withCredentials",G],maxFileSize:[2,"maxFileSize","maxFileSize",oe],invalidFileSizeMessageSummary:"invalidFileSizeMessageSummary",invalidFileSizeMessageDetail:"invalidFileSizeMessageDetail",invalidFileTypeMessageSummary:"invalidFileTypeMessageSummary",invalidFileTypeMessageDetail:"invalidFileTypeMessageDetail",invalidFileLimitMessageDetail:"invalidFileLimitMessageDetail",invalidFileLimitMessageSummary:"invalidFileLimitMessageSummary",style:"style",styleClass:"styleClass",previewWidth:[2,"previewWidth","previewWidth",oe],chooseLabel:"chooseLabel",uploadLabel:"uploadLabel",cancelLabel:"cancelLabel",chooseIcon:"chooseIcon",uploadIcon:"uploadIcon",cancelIcon:"cancelIcon",showUploadButton:[2,"showUploadButton","showUploadButton",G],showCancelButton:[2,"showCancelButton","showCancelButton",G],mode:"mode",headers:"headers",customUpload:[2,"customUpload","customUpload",G],fileLimit:[2,"fileLimit","fileLimit",e=>oe(e,null)],uploadStyleClass:"uploadStyleClass",cancelStyleClass:"cancelStyleClass",removeStyleClass:"removeStyleClass",chooseStyleClass:"chooseStyleClass",chooseButtonProps:"chooseButtonProps",uploadButtonProps:"uploadButtonProps",cancelButtonProps:"cancelButtonProps",files:"files"},outputs:{onBeforeUpload:"onBeforeUpload",onSend:"onSend",onUpload:"onUpload",onError:"onError",onClear:"onClear",onRemove:"onRemove",onSelect:"onSelect",onProgress:"onProgress",uploadHandler:"uploadHandler",onImageError:"onImageError",onRemoveUploadedFile:"onRemoveUploadedFile"},features:[Y([Rn]),De,X],decls:2,vars:2,consts:[["advancedfileinput",""],["content",""],["icon",""],["basicfileinput",""],[3,"ngClass","ngStyle","class",4,"ngIf"],[3,"ngClass","class",4,"ngIf"],[3,"ngClass","ngStyle"],["type","file",3,"change","multiple","accept","disabled"],[1,"p-fileupload-header"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[1,"p-fileupload-content",3,"dragenter","dragleave","drop"],[3,"value","showValue",4,"ngIf"],[3,"severity","text"],["class","p-fileupload-file-list",4,"ngIf"],[3,"focus","blur","onClick","keydown.enter","styleClass","disabled","label","buttonProps"],[3,"class",4,"ngIf"],[3,"label","disabled","styleClass","buttonProps","onClick",4,"ngIf"],[3,"onClick","label","disabled","styleClass","buttonProps"],[3,"ngClass",4,"ngIf"],[3,"ngClass"],[3,"value","showValue"],[1,"p-fileupload-file-list"],[1,"p-fileupload-file"],["ngFor","",3,"ngForOf","ngForTemplate"],["class","p-fileupload-file",4,"ngFor","ngForOf"],["class","p-fileupload-file-thumbnail",3,"src","width","error",4,"ngIf"],[1,"p-fileupload-file-info"],[1,"p-fileupload-file-name"],[1,"p-fileupload-file-size"],[1,"p-fileupload-file-actions"],["text","","rounded","","severity","danger",3,"onClick","disabled","styleClass"],[1,"p-fileupload-file-thumbnail",3,"error","src","width"],[3,"onClick","keydown","styleClass","disabled","label","buttonProps"],["type","file",3,"change","focus","blur","accept","multiple","disabled"],["class","p-button-icon p-button-icon-left",3,"ngClass",4,"ngIf"],[1,"p-button-icon","p-button-icon-left",3,"ngClass"],[3,"styleClass",4,"ngIf"],["class","p-button-icon p-button-icon-left",4,"ngIf"],[3,"styleClass"],[1,"p-button-icon","p-button-icon-left"],["class","p-button-icon p-button-icon-left pi",3,"ngClass",4,"ngIf"],[1,"p-button-icon","p-button-icon-left","pi",3,"ngClass"],[3,"class"]],template:function(i,o){i&1&&u(0,Mo,15,39,"div",4)(1,Ho,9,16,"div",5),i&2&&(p("ngIf",o.mode==="advanced"),s(),p("ngIf",o.mode==="basic"))},dependencies:[U,me,ke,k,ge,he,ve,Cn,bn,kt,yn,Nt,B],encapsulation:2,changeDetection:0})}return n})(),Ln=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=de({type:n});static \u0275inj=pe({imports:[Go,B,B]})}return n})();function Jo(n,t){if(n&1&&(r(0,"small",40),c(1),a()),n&2){let e=d(2);s(),T(" ",e.getFieldError("numero")," ")}}function Ko(n,t){if(n&1){let e=E();r(0,"div",12)(1,"div",13)(2,"label",14),c(3," N\xB0 D\xE9pense "),r(4,"span",15),c(5,"*"),a()(),r(6,"input",39),_("blur",function(){h(e);let o=d();return g(o.onNumeroBlur())}),a(),u(7,Jo,2,1,"small",17),a()()}if(n&2){let e=d();s(6),j("p-invalid",e.isFieldInvalid("numero")),p("readonly",e.editMode),s(),p("ngIf",e.isFieldInvalid("numero"))}}function Zo(n,t){if(n&1&&(r(0,"small",40),c(1),a()),n&2){let e=d();s(),T(" ",e.getFieldError("dateDepense")," ")}}function er(n,t){if(n&1&&(r(0,"small",40),c(1),a()),n&2){let e=d();s(),T(" ",e.getFieldError("categorieId")," ")}}function tr(n,t){if(n&1&&(r(0,"small",40),c(1),a()),n&2){let e=d();s(),T(" ",e.getFieldError("titre")," ")}}function nr(n,t){if(n&1&&(r(0,"small",40),c(1),a()),n&2){let e=d();s(),T(" ",e.getFieldError("description")," ")}}function ir(n,t){if(n&1&&(r(0,"div",47),c(1),a()),n&2){let e=d(2);s(),I(e.selectedSupplier.raisonSociale)}}function or(n,t){if(n&1&&(r(0,"div",47),f(1,"i",48),c(2),a()),n&2){let e=d(2);s(2),T("",e.selectedSupplier.adresse," ")}}function rr(n,t){if(n&1&&(r(0,"span"),f(1,"i",49),c(2),a()),n&2){let e=d(2);s(2),T("",e.selectedSupplier.telephone," ")}}function ar(n,t){if(n&1&&(r(0,"span"),f(1,"i",50),c(2),a()),n&2){let e=d(2);s(2),T("",e.selectedSupplier.email," ")}}function sr(n,t){if(n&1&&(r(0,"div",19)(1,"div",41)(2,"div",42)(3,"div",43),c(4),a(),u(5,ir,2,1,"div",44)(6,or,3,1,"div",44),r(7,"div",45),u(8,rr,3,1,"span",46)(9,ar,3,1,"span",46),a()()()()),n&2){let e=d();s(4),I(e.selectedSupplier.nom),s(),p("ngIf",e.selectedSupplier.raisonSociale),s(),p("ngIf",e.selectedSupplier.adresse),s(2),p("ngIf",e.selectedSupplier.telephone),s(),p("ngIf",e.selectedSupplier.email)}}function lr(n,t){if(n&1){let e=E();r(0,"div",27)(1,"div",13)(2,"label",14),c(3," Taux de change (1 EUR = X XOF) "),a(),r(4,"p-inputNumber",51),_("onInput",function(){h(e);let o=d();return g(o.onExchangeRateChange())}),a(),r(5,"small",5),c(6),a()()()}if(n&2){let e=d();s(4),p("min",.01)("maxFractionDigits",6),s(2),T(" Taux de change approximatif : 1 EUR = ",e.DEFAULT_EXCHANGE_RATE," XOF ")}}function pr(n,t){if(n&1&&(r(0,"small",40),c(1),a()),n&2){let e=d();s(),T(" ",e.getFieldError("montantXOF")," ")}}function dr(n,t){n&1&&(r(0,"span",15),c(1,"*"),a())}function cr(n,t){if(n&1&&(r(0,"small",40),c(1),a()),n&2){let e=d(2);s(),T(" ",e.getFieldError("montantEURO")," ")}}function ur(n,t){if(n&1){let e=E();r(0,"div",27)(1,"div",13)(2,"label",14),c(3," Montant en EUR "),u(4,dr,2,0,"span",52),a(),r(5,"p-inputNumber",53),_("onInput",function(){h(e);let o=d();return g(o.onEuroAmountChange())}),a(),u(6,cr,2,1,"small",17),a()()}if(n&2){let e,i=d();s(4),p("ngIf",((e=i.expenseForm.get("devise"))==null?null:e.value)==="EUR"),s(),j("p-invalid",i.isFieldInvalid("montantEURO")),p("min",i.MIN_AMOUNT),s(),p("ngIf",i.isFieldInvalid("montantEURO"))}}function mr(n,t){if(n&1&&(r(0,"span"),c(1),a()),n&2){let e,i=d(2);s(),T(" (Taux : ",(e=i.expenseForm.get("tauxChange"))==null?null:e.value,") ")}}function hr(n,t){if(n&1&&(r(0,"div",19)(1,"div",54)(2,"div",55),f(3,"i",56),r(4,"strong"),c(5,"Conversion :"),a(),c(6),u(7,mr,2,1,"span",46),a()()()),n&2){let e,i,o=d();s(6),ce(" ",o.formatCurrency((e=o.expenseForm.get("montantXOF"))==null?null:e.value,o.Currency.XOF)," \u21C4 ",o.formatCurrency((e=o.expenseForm.get("montantEURO"))==null?null:e.value,o.Currency.EUR)," "),s(),p("ngIf",(i=o.expenseForm.get("tauxChange"))==null?null:i.value)}}function gr(n,t){if(n&1&&(r(0,"small",40),c(1),a()),n&2){let e=d();s(),T(" ",e.getFieldError("paymentMethodId")," ")}}function _r(n,t){n&1&&(r(0,"div",57)(1,"div",58)(2,"div",59),f(3,"span",60),r(4,"div",61)(5,"div",62),c(6,"Formulaire incomplet"),a(),r(7,"div",63),c(8,"Veuillez remplir tous les champs obligatoires marqu\xE9s d'un ast\xE9risque (*)"),a()()()()())}function fr(n,t){if(n&1&&(r(0,"div"),c(1),ie(2,"date"),a()),n&2){let e=d(2);s(),T(" Modifi\xE9e le : ",ue(2,1,e.expense.updatedAt,"dd/MM/yyyy \xE0 HH:mm")," ")}}function xr(n,t){if(n&1&&(r(0,"div",64)(1,"div",65)(2,"div",59),f(3,"span",66),r(4,"div",61)(5,"div",62),c(6,"Informations de la d\xE9pense"),a(),r(7,"div",67)(8,"div"),c(9,"Statut actuel : "),r(10,"span",62),c(11),a()(),r(12,"div"),c(13),ie(14,"date"),a(),u(15,fr,3,4,"div",46),a()()()()()),n&2){let e=d();s(11),I(e.expense.statutLabel||e.expense.statut),s(2),T("Cr\xE9\xE9e le : ",ue(14,3,e.expense.createdAt,"dd/MM/yyyy \xE0 HH:mm"),""),s(2),p("ngIf",e.expense.updatedAt!==e.expense.createdAt)}}var at=class n{expense=null;editMode=!1;visible=!1;onSave=new w;onCancel=new w;fb=v(pn);expenseService=v(Z);expenseCategoryService=v(et);expenseSupplierService=v(tt);paymentMethodService=v(nt);messageService=v(re);logger=v(be);expenseForm;saving=!1;loadingOptions=!1;categoryOptions=[];supplierOptions=[];paymentMethodOptions=[];currencyOptions=[];selectedCategory=null;selectedSupplier=null;selectedPaymentMethod=null;showEuroFields=!1;autoGenerateNumber=!0;exchangeRateSubject=new q;DEFAULT_EXCHANGE_RATE=656;MIN_AMOUNT=.01;MAX_DESCRIPTION_LENGTH=1e3;destroy$=new q;ngOnInit(){this.initializeForm(),this.initializeOptions(),this.setupExchangeRateCalculation(),this.logger.info("ExpenseFormComponent initialis\xE9",{editMode:this.editMode})}ngOnChanges(t){t.expense&&this.expense&&this.expenseForm&&this.populateForm(),t.visible&&this.visible&&!this.editMode&&this.generateExpenseNumber()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeForm(){this.generateExpenseNumber(),this.expenseForm=this.fb.group({numero:["",[O.required,O.maxLength(20)]],titre:["",[O.required,O.minLength(2),O.maxLength(255)]],description:["",[O.maxLength(this.MAX_DESCRIPTION_LENGTH)]],categorieId:[null,O.required],fournisseurId:[null],dateDepense:[new Date,O.required],montantXOF:[null,[O.required,O.min(this.MIN_AMOUNT)]],montantEURO:[null,O.min(this.MIN_AMOUNT)],tauxChange:[this.DEFAULT_EXCHANGE_RATE,O.min(.01)],devise:["XOF",O.required],paymentMethodId:[null,O.required],statut:["EN_ATTENTE"]}),this.expenseForm.get("devise")?.valueChanges.pipe(b(this.destroy$)).subscribe(t=>{this.onCurrencyChange(t)})}initializeOptions(){this.loadingOptions=!0,this.currencyOptions=Object.values(Ce).map(t=>({label:Fn[t],value:t})),this.expenseCategoryService.getCategories().pipe(b(this.destroy$)).subscribe({next:t=>{this.categoryOptions=t.data.categories.map(e=>({label:e.nom,value:e.id})),this.logger.debug("Cat\xE9gories charg\xE9es",{count:t.data.total})},error:t=>{this.logger.error("Erreur chargement cat\xE9gories",t)}}),this.expenseSupplierService.getSuppliers().pipe(b(this.destroy$)).subscribe({next:t=>{this.supplierOptions=[{label:"Aucun fournisseur sp\xE9cifique",value:null},...t.data.suppliers.map(e=>({label:e.nom,value:e.id}))],this.logger.debug("Fournisseurs charg\xE9s",{count:t.data.total})},error:t=>{this.logger.error("Erreur chargement fournisseurs",t)}}),this.paymentMethodService.getPaymentMethods().pipe(b(this.destroy$)).subscribe({next:t=>{this.paymentMethodOptions=t.data.paymentMethods.map(e=>({label:e.nom,value:e.id})),this.logger.debug("Modes de paiement charg\xE9s",{count:t.data.totalElements})},error:t=>{this.logger.error("Erreur chargement modes de paiement",t)}}),this.loadingOptions=!1}setupExchangeRateCalculation(){this.exchangeRateSubject.pipe(Se(300),b(this.destroy$)).subscribe(()=>{this.calculateAmounts()})}generateExpenseNumber(){!this.editMode&&this.autoGenerateNumber&&this.expenseService.generateNumero().pipe(b(this.destroy$)).subscribe({next:t=>{this.expenseForm.patchValue({numero:t}),this.logger.debug("Num\xE9ro g\xE9n\xE9r\xE9",t)},error:t=>{this.logger.error("Erreur g\xE9n\xE9ration num\xE9ro",t);let e=this.generateFallbackNumber();this.expenseForm.patchValue({numero:e})}})}generateFallbackNumber(){let t=new Date,e=t.toISOString().split("T")[0].replace(/-/g,""),i=t.getTime().toString().slice(-4);return`DEP-${e}-${i}`}populateForm(){this.expense&&(this.autoGenerateNumber=!1,this.expenseForm.patchValue({numero:this.expense.numero,titre:this.expense.titre,description:this.expense.description,categorieId:this.expense.categorieId,fournisseurId:this.expense.fournisseurId,dateDepense:new Date(this.expense.dateDepense),montantXOF:this.expense.montantXOF,montantEURO:this.expense.montantEURO,tauxChange:this.expense.tauxChange||this.DEFAULT_EXCHANGE_RATE,devise:this.expense.devise,paymentMethodId:this.expense.paymentMethodId,statut:this.expense.statut}),this.updateSelectedObjects(),this.showEuroFields=this.expense.devise==="EUR"||!!this.expense.montantEURO,this.logger.debug("Formulaire popul\xE9",{expenseId:this.expense.id}))}onCategoryChange(t){let e=t.value;this.selectedCategory=this.categoryOptions.find(i=>i.value===e),this.logger.debug("Cat\xE9gorie s\xE9lectionn\xE9e",{categoryId:e})}onSupplierChange(t){let e=t.value;e?this.expenseSupplierService.getSupplierById(e).pipe(b(this.destroy$)).subscribe({next:i=>{this.selectedSupplier=i,this.logger.debug("Fournisseur s\xE9lectionn\xE9",{supplierId:e})},error:i=>{this.logger.error("Erreur chargement fournisseur",i),this.selectedSupplier=null}}):this.selectedSupplier=null}onPaymentMethodChange(t){let e=t.value;this.selectedPaymentMethod=this.paymentMethodOptions.find(i=>i.value===e)||null,this.logger.debug("Mode de paiement s\xE9lectionn\xE9",{paymentMethodId:e})}onCurrencyChange(t){this.showEuroFields=t==="EUR",t==="XOF"?this.expenseForm.get("montantEURO")?.setValidators([O.min(this.MIN_AMOUNT)]):this.expenseForm.get("montantEURO")?.setValidators([O.required,O.min(this.MIN_AMOUNT)]),this.expenseForm.get("montantEURO")?.updateValueAndValidity(),this.calculateAmounts(),this.logger.debug("Devise chang\xE9e",{devise:t,showEuroFields:this.showEuroFields})}onAmountChange(){this.exchangeRateSubject.next()}onEuroAmountChange(){this.exchangeRateSubject.next()}onExchangeRateChange(){this.exchangeRateSubject.next()}onNumeroBlur(){let t=this.expenseForm.get("numero")?.value;t&&!this.editMode&&this.checkNumeroUniqueness(t)}calculateAmounts(){let t=this.expenseForm.get("devise")?.value,e=this.expenseForm.get("montantXOF")?.value,i=this.expenseForm.get("montantEURO")?.value,o=this.expenseForm.get("tauxChange")?.value||this.DEFAULT_EXCHANGE_RATE;if(t==="XOF"&&e&&o){let l=e/o;this.expenseForm.patchValue({montantEURO:Math.round(l*100)/100},{emitEvent:!1})}else if(t==="EUR"&&i&&o){let l=i*o;this.expenseForm.patchValue({montantXOF:Math.round(l)},{emitEvent:!1})}}checkNumeroUniqueness(t){this.expenseService.checkNumeroExists(t,this.expense?.id).pipe(b(this.destroy$)).subscribe({next:e=>{e&&(this.expenseForm.get("numero")?.setErrors({notUnique:!0}),this.messageService.add({severity:"warn",summary:"Attention",detail:"Ce num\xE9ro de d\xE9pense existe d\xE9j\xE0"}))},error:e=>{this.logger.error("Erreur v\xE9rification unicit\xE9",e)}})}updateSelectedObjects(){let t=this.expenseForm.get("categorieId")?.value,e=this.expenseForm.get("fournisseurId")?.value,i=this.expenseForm.get("paymentMethodId")?.value;t&&(this.selectedCategory=this.categoryOptions.find(o=>o.value===t)),e&&this.onSupplierChange({value:e}),i&&(this.selectedPaymentMethod=this.paymentMethodOptions.find(o=>o.value===i)||null)}onSubmit(){if(this.expenseForm.invalid){this.markFormGroupTouched(this.expenseForm),this.messageService.add({severity:"warn",summary:"Formulaire invalide",detail:"Veuillez corriger les erreurs avant de continuer"});return}this.saving=!0;let t=this.expenseForm.value;if(this.editMode&&this.expense){let e={numero:t.numero,titre:t.titre,description:t.description,categorieId:t.categorieId,fournisseurId:t.fournisseurId||void 0,dateDepense:new Date(t.dateDepense).toISOString().split("T")[0],montantXOF:t.montantXOF,montantEURO:t.montantEURO||void 0,tauxChange:t.tauxChange||void 0,devise:t.devise,paymentMethodId:t.paymentMethodId};this.logger.info("Soumission mise \xE0 jour d\xE9pense",{id:this.expense.id}),this.onSave.emit(e)}else{let e={titre:t.titre,description:t.description,categorieId:t.categorieId,fournisseurId:t.fournisseurId||void 0,dateDepense:new Date(t.dateDepense).toISOString().split("T")[0],montantXOF:t.montantXOF,montantEURO:t.montantEURO||void 0,tauxChange:t.tauxChange||void 0,devise:t.devise,paymentMethodId:t.paymentMethodId,statut:t.statut};this.logger.info("Soumission cr\xE9ation d\xE9pense"),this.onSave.emit(e)}this.saving=!1}onCancelClick(){this.resetForm(),this.onCancel.emit(),this.logger.debug("Formulaire annul\xE9")}onResetClick(){this.resetForm(),this.editMode||this.generateExpenseNumber()}resetForm(){this.expenseForm.reset(),this.selectedCategory=null,this.selectedSupplier=null,this.selectedPaymentMethod=null,this.showEuroFields=!1,this.autoGenerateNumber=!0,this.expenseForm.patchValue({dateDepense:new Date,devise:"XOF",tauxChange:this.DEFAULT_EXCHANGE_RATE,statut:"EN_ATTENTE"})}markFormGroupTouched(t){Object.keys(t.controls).forEach(e=>{let i=t.get(e);i?.markAsTouched(),i instanceof nn&&this.markFormGroupTouched(i)})}get isFormValid(){return this.expenseForm.valid}get isFormDirty(){return this.expenseForm.dirty}get numeroControl(){return this.expenseForm.get("numero")}get titreControl(){return this.expenseForm.get("titre")}get descriptionControl(){return this.expenseForm.get("description")}get categorieControl(){return this.expenseForm.get("categorieId")}get montantXOFControl(){return this.expenseForm.get("montantXOF")}get montantEURControl(){return this.expenseForm.get("montantEURO")}get dateDepenseControl(){return this.expenseForm.get("dateDepense")}get paymentMethodControl(){return this.expenseForm.get("paymentMethodId")}getFieldError(t){let e=this.expenseForm.get(t);if(e?.errors&&e.touched){if(e.errors.required)return`${t} est obligatoire`;if(e.errors.minlength)return`${t} trop court`;if(e.errors.maxlength)return`${t} trop long`;if(e.errors.min)return"Valeur minimale non respect\xE9e";if(e.errors.notUnique)return"Ce num\xE9ro existe d\xE9j\xE0"}return null}isFieldInvalid(t){let e=this.expenseForm.get(t);return!!(e?.invalid&&e.touched)}formatCurrency(t,e="XOF"){return e==="XOF"?new Intl.NumberFormat("fr-SN",{style:"currency",currency:"XOF",minimumFractionDigits:0}).format(t):new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR",minimumFractionDigits:2}).format(t)}Currency=Ce;static \u0275fac=function(e){return new(e||n)};static \u0275cmp=P({type:n,selectors:[["app-expense-form"]],inputs:{expense:"expense",editMode:"editMode",visible:"visible"},outputs:{onSave:"onSave",onCancel:"onCancel"},features:[ft],decls:105,vars:51,consts:[[1,"expense-form"],[3,"ngSubmit","formGroup"],[1,"form-header","mb-6"],[1,"text-2xl","font-semibold","text-900","mb-2"],[1,"pi","pi-receipt","mr-2","text-primary"],[1,"text-color-secondary"],[1,"form-section","mb-6"],[1,"section-header","mb-4"],[1,"pi","pi-info-circle","text-primary","mr-2"],[1,"text-lg","font-medium","text-primary","m-0"],[1,"grid"],["class","col-12 md:col-4",4,"ngIf"],[1,"col-12","md:col-4"],[1,"field"],[1,"field-label"],[1,"text-red-500"],["formControlName","dateDepense","dateFormat","dd/mm/yy","placeholder","S\xE9lectionner la date",1,"field-input","w-full",3,"showIcon"],["class","field-error",4,"ngIf"],["formControlName","categorieId","placeholder","S\xE9lectionner une cat\xE9gorie","optionLabel","label","optionValue","value","filterBy","label",1,"field-input","w-full",3,"onChange","options","filter","loading"],[1,"col-12"],["type","text","pInputText","","formControlName","titre","placeholder","Ex: Achat carburant pour mission",1,"field-input"],["pInputTextarea","","formControlName","description","placeholder","Description d\xE9taill\xE9e de la d\xE9pense...","rows","3",1,"field-textarea",3,"maxlength"],[1,"flex","justify-content-between","mt-1"],[1,"pi","pi-users","text-primary","mr-2"],["formControlName","fournisseurId","placeholder","S\xE9lectionner un fournisseur (optionnel)","optionLabel","label","optionValue","value","filterBy","label",1,"field-input","w-full",3,"onChange","options","filter","showClear","loading"],["class","col-12",4,"ngIf"],[1,"pi","pi-dollar","text-primary","mr-2"],[1,"col-12","md:col-6"],["formControlName","devise","placeholder","S\xE9lectionner la devise","optionLabel","label","optionValue","value",1,"field-input","w-full",3,"options"],["class","col-12 md:col-6",4,"ngIf"],["formControlName","montantXOF","mode","currency","currency","XOF","locale","fr-SN",1,"field-input","w-full",3,"onInput","min"],[1,"pi","pi-credit-card","text-primary","mr-2"],["formControlName","paymentMethodId","placeholder","S\xE9lectionner le mode de paiement","optionLabel","label","optionValue","value",1,"field-input","w-full",3,"onChange","options","loading"],[1,"form-actions"],["type","button","pButton","","label","Annuler","icon","pi pi-times","severity","secondary",3,"click","outlined","disabled"],["type","button","pButton","","label","R\xE9initialiser","icon","pi pi-refresh","severity","secondary",1,"ml-2",3,"click","outlined","disabled"],["type","submit","pButton","","severity","primary",1,"ml-2",3,"label","icon","loading","disabled"],["class","form-validation-info mt-4",4,"ngIf"],["class","expense-meta-info mt-6",4,"ngIf"],["type","text","pInputText","","formControlName","numero","placeholder","Num\xE9ro automatique",1,"field-input",3,"blur","readonly"],[1,"field-error"],[1,"supplier-info"],[1,"text-sm","text-600"],[1,"font-medium","text-900","mb-1"],["class","mb-1",4,"ngIf"],[1,"flex","gap-3"],[4,"ngIf"],[1,"mb-1"],[1,"pi","pi-map-marker","mr-1"],[1,"pi","pi-phone","mr-1"],[1,"pi","pi-envelope","mr-1"],["formControlName","tauxChange","placeholder","Taux de change",1,"field-input","w-full",3,"onInput","min","maxFractionDigits"],["class","text-red-500",4,"ngIf"],["formControlName","montantEURO","mode","currency","currency","EUR","locale","fr-FR",1,"field-input","w-full",3,"onInput","min"],[1,"conversion-info"],[1,"text-sm","text-color-secondary"],[1,"pi","pi-info-circle","mr-2"],[1,"form-validation-info","mt-4"],[1,"p-message","p-message-warn"],[1,"p-message-wrapper"],[1,"p-message-icon","pi","pi-exclamation-triangle"],[1,"p-message-text"],[1,"font-medium"],[1,"text-sm"],[1,"expense-meta-info","mt-6"],[1,"p-message","p-message-info"],[1,"p-message-icon","pi","pi-info-circle"],[1,"text-sm","mt-1"]],template:function(e,i){if(e&1&&(r(0,"div",0)(1,"form",1),_("ngSubmit",function(){return i.onSubmit()}),r(2,"div",2)(3,"h2",3),f(4,"i",4),c(5),a(),r(6,"p",5),c(7),a()(),r(8,"div",6)(9,"div",7),f(10,"i",8),r(11,"h3",9),c(12,"Informations g\xE9n\xE9rales"),a()(),r(13,"div",10),u(14,Ko,8,4,"div",11),r(15,"div",12)(16,"div",13)(17,"label",14),c(18," Date de d\xE9pense "),r(19,"span",15),c(20,"*"),a()(),f(21,"p-calendar",16),u(22,Zo,2,1,"small",17),a()(),r(23,"div",12)(24,"div",13)(25,"label",14),c(26," Cat\xE9gorie "),r(27,"span",15),c(28,"*"),a()(),r(29,"p-dropdown",18),_("onChange",function(l){return i.onCategoryChange(l)}),a(),u(30,er,2,1,"small",17),a()(),r(31,"div",19)(32,"div",13)(33,"label",14),c(34," Titre "),r(35,"span",15),c(36,"*"),a()(),f(37,"input",20),u(38,tr,2,1,"small",17),a()(),r(39,"div",19)(40,"div",13)(41,"label",14),c(42,"Description"),a(),r(43,"textarea",21),c(44,"                        "),a(),r(45,"div",22),u(46,nr,2,1,"small",17),r(47,"small",5),c(48),a()()()()()(),r(49,"div",6)(50,"div",7),f(51,"i",23),r(52,"h3",9),c(53,"Fournisseur"),a()(),r(54,"div",10)(55,"div",19)(56,"div",13)(57,"label",14),c(58,"Fournisseur"),a(),r(59,"p-dropdown",24),_("onChange",function(l){return i.onSupplierChange(l)}),a()()(),u(60,sr,10,5,"div",25),a()(),r(61,"div",6)(62,"div",7),f(63,"i",26),r(64,"h3",9),c(65,"Montant et devise"),a()(),r(66,"div",10)(67,"div",27)(68,"div",13)(69,"label",14),c(70," Devise "),r(71,"span",15),c(72,"*"),a()(),f(73,"p-dropdown",28),a()(),u(74,lr,7,3,"div",29),r(75,"div",27)(76,"div",13)(77,"label",14),c(78," Montant en XOF "),r(79,"span",15),c(80,"*"),a()(),r(81,"p-inputNumber",30),_("onInput",function(){return i.onAmountChange()}),a(),u(82,pr,2,1,"small",17),a()(),u(83,ur,7,5,"div",29)(84,hr,8,3,"div",25),a()(),r(85,"div",6)(86,"div",7),f(87,"i",31),r(88,"h3",9),c(89,"Mode de paiement"),a()(),r(90,"div",10)(91,"div",19)(92,"div",13)(93,"label",14),c(94," Mode de paiement "),r(95,"span",15),c(96,"*"),a()(),r(97,"p-dropdown",32),_("onChange",function(l){return i.onPaymentMethodChange(l)}),a(),u(98,gr,2,1,"small",17),a()()()(),r(99,"div",33)(100,"button",34),_("click",function(){return i.onCancelClick()}),a(),r(101,"button",35),_("click",function(){return i.onResetClick()}),a(),f(102,"button",36),a(),u(103,_r,9,0,"div",37)(104,xr,16,6,"div",38),a()()),e&2){let o,l;s(),p("formGroup",i.expenseForm),s(4),T(" ",i.editMode?"Modifier la d\xE9pense":"Nouvelle d\xE9pense"," "),s(2),T(" ",i.editMode?"Modifiez les informations de la d\xE9pense":"Remplissez les informations de la nouvelle d\xE9pense"," "),s(7),p("ngIf",i.editMode),s(7),j("p-invalid",i.isFieldInvalid("dateDepense")),p("showIcon",!0),s(),p("ngIf",i.isFieldInvalid("dateDepense")),s(7),j("p-invalid",i.isFieldInvalid("categorieId")),p("options",i.categoryOptions)("filter",!0)("loading",i.loadingOptions),s(),p("ngIf",i.isFieldInvalid("categorieId")),s(7),j("p-invalid",i.isFieldInvalid("titre")),s(),p("ngIf",i.isFieldInvalid("titre")),s(5),j("p-invalid",i.isFieldInvalid("description")),p("maxlength",i.MAX_DESCRIPTION_LENGTH),s(3),p("ngIf",i.isFieldInvalid("description")),s(2),ce(" ",((o=i.expenseForm.get("description"))==null?null:o.value)||0,"/",i.MAX_DESCRIPTION_LENGTH," "),s(11),p("options",i.supplierOptions)("filter",!0)("showClear",!0)("loading",i.loadingOptions),s(),p("ngIf",i.selectedSupplier),s(13),p("options",i.currencyOptions),s(),p("ngIf",i.showEuroFields),s(7),j("p-invalid",i.isFieldInvalid("montantXOF")),p("min",i.MIN_AMOUNT),s(),p("ngIf",i.isFieldInvalid("montantXOF")),s(),p("ngIf",i.showEuroFields),s(),p("ngIf",i.showEuroFields&&((l=i.expenseForm.get("montantXOF"))==null?null:l.value)&&((l=i.expenseForm.get("montantEURO"))==null?null:l.value)),s(13),j("p-invalid",i.isFieldInvalid("paymentMethodId")),p("options",i.paymentMethodOptions)("loading",i.loadingOptions),s(),p("ngIf",i.isFieldInvalid("paymentMethodId")),s(2),p("outlined",!0)("disabled",i.saving),s(),p("outlined",!0)("disabled",i.saving),s(),p("label",i.editMode?"Mettre \xE0 jour":"Cr\xE9er la d\xE9pense")("icon",i.editMode?"pi pi-check":"pi pi-plus")("loading",i.saving)("disabled",!i.isFormValid),s(),p("ngIf",!i.isFormValid),s(),p("ngIf",i.editMode&&i.expense)}},dependencies:[U,k,Ne,cn,rn,Xe,Qe,tn,ln,an,sn,Ee,Bt,Ye,We,Ze,Ke,ot,it,Je,Ge,He,Ln,je,En],styles:["[_nghost-%COMP%]{display:block}.expense-form[_ngcontent-%COMP%]{max-width:1000px;margin:0 auto;padding:1.5rem}@media (max-width: 768px){.expense-form[_ngcontent-%COMP%]{padding:1rem}}.form-header[_ngcontent-%COMP%]{text-align:left;border-bottom:1px solid #e5e7eb;padding-bottom:1rem}.form-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#111827;margin-bottom:.5rem}.form-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{color:var(--primary-500, #3b82f6)}.form-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem}.form-section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:1.5rem;box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f;border:1px solid #f3f4f6;transition:box-shadow .2s ease-in-out}.form-section[_ngcontent-%COMP%]:hover{box-shadow:0 4px 6px #0000000d,0 1px 3px #0000001a}@media (max-width: 768px){.form-section[_ngcontent-%COMP%]{padding:1rem}}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;border-bottom:1px solid #e5e7eb;padding-bottom:.75rem;margin-bottom:1.5rem}.section-header[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{font-size:1.125rem;color:var(--primary-500, #3b82f6)}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-weight:600;color:var(--primary-700, #1d4ed8)}.field[_ngcontent-%COMP%]{margin-bottom:1.5rem}.field[_ngcontent-%COMP%]:last-child{margin-bottom:0}.field-label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:#374151;margin-bottom:.5rem;line-height:1.4}.field-label[_ngcontent-%COMP%]   .text-red-500[_ngcontent-%COMP%]{color:#ef4444}.field-input[_ngcontent-%COMP%]{width:100%}.field-textarea[_ngcontent-%COMP%]{width:100%;resize:vertical;border:1px solid #d1d5db;border-radius:8px;padding:.75rem;font-size:.875rem;font-family:inherit;line-height:1.5;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out;min-height:80px}.field-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-500, #3b82f6);box-shadow:0 0 0 3px #3b82f61a}.field-textarea[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.field-textarea.p-invalid[_ngcontent-%COMP%]{border-color:#ef4444}.field-textarea.p-invalid[_ngcontent-%COMP%]:focus{border-color:#ef4444;box-shadow:0 0 0 3px #ef44441a}.field-error[_ngcontent-%COMP%]{display:block;font-size:.75rem;color:#ef4444;margin-top:.25rem;line-height:1.4}.supplier-info[_ngcontent-%COMP%]{margin-top:.75rem;padding:1rem;background:linear-gradient(135deg,#f8fafc,#f1f5f9);border:1px solid #e2e8f0;border-radius:8px;border-left:4px solid var(--primary-500, #3b82f6)}.supplier-info[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{color:var(--primary-600, #2563eb);font-size:.75rem}.conversion-info[_ngcontent-%COMP%]{padding:.75rem;background:linear-gradient(135deg,#ecfdf5,#f0fdf4);border:1px solid #bbf7d0;border-radius:8px;border-left:4px solid #10b981}.conversion-info[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{color:#059669}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;gap:.75rem;margin-top:2rem;padding-top:1.5rem;border-top:1px solid #e5e7eb}@media (max-width: 768px){.form-actions[_ngcontent-%COMP%]{flex-direction:column-reverse;gap:.5rem}.form-actions[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]{width:100%;justify-content:center}}.form-validation-info[_ngcontent-%COMP%]{margin-top:1rem}.form-validation-info[_ngcontent-%COMP%]   .p-message[_ngcontent-%COMP%]{border-radius:8px}.form-validation-info[_ngcontent-%COMP%]   .p-message[_ngcontent-%COMP%]   .p-message-text[_ngcontent-%COMP%]{font-size:.875rem}.expense-meta-info[_ngcontent-%COMP%]   .p-message[_ngcontent-%COMP%]{border-radius:8px}.expense-meta-info[_ngcontent-%COMP%]   .p-message[_ngcontent-%COMP%]   .p-message-text[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.5}[_ngcontent-%COMP%]:deep(.p-inputtext), [_ngcontent-%COMP%]:deep(.p-dropdown), [_ngcontent-%COMP%]:deep(.p-calendar), [_ngcontent-%COMP%]:deep(.p-inputnumber){border:1px solid #d1d5db;border-radius:8px;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}[_ngcontent-%COMP%]:deep(.p-inputtext):enabled:focus, [_ngcontent-%COMP%]:deep(.p-dropdown):enabled:focus, [_ngcontent-%COMP%]:deep(.p-calendar):enabled:focus, [_ngcontent-%COMP%]:deep(.p-inputnumber):enabled:focus{border-color:var(--primary-500, #3b82f6);box-shadow:0 0 0 3px #3b82f61a}[_ngcontent-%COMP%]:deep(.p-inputtext).p-invalid, [_ngcontent-%COMP%]:deep(.p-dropdown).p-invalid, [_ngcontent-%COMP%]:deep(.p-calendar).p-invalid, [_ngcontent-%COMP%]:deep(.p-inputnumber).p-invalid{border-color:#ef4444}[_ngcontent-%COMP%]:deep(.p-inputtext).p-invalid:enabled:focus, [_ngcontent-%COMP%]:deep(.p-dropdown).p-invalid:enabled:focus, [_ngcontent-%COMP%]:deep(.p-calendar).p-invalid:enabled:focus, [_ngcontent-%COMP%]:deep(.p-inputnumber).p-invalid:enabled:focus{border-color:#ef4444;box-shadow:0 0 0 3px #ef44441a}[_ngcontent-%COMP%]:deep(.p-dropdown)   .p-dropdown-trigger[_ngcontent-%COMP%]{border-left:1px solid #d1d5db}[_ngcontent-%COMP%]:deep(.p-dropdown):not(.p-disabled).p-focus   .p-dropdown-trigger[_ngcontent-%COMP%]{border-left-color:var(--primary-500, #3b82f6)}[_ngcontent-%COMP%]:deep(.p-calendar)   .p-datepicker-trigger[_ngcontent-%COMP%]{border-left:1px solid #d1d5db}[_ngcontent-%COMP%]:deep(.p-calendar):not(.p-disabled).p-focus   .p-datepicker-trigger[_ngcontent-%COMP%]{border-left-color:var(--primary-500, #3b82f6)}[_ngcontent-%COMP%]:deep(.p-inputnumber).p-inputnumber-buttons-stacked   .p-inputnumber-button[_ngcontent-%COMP%]{border-left:1px solid #d1d5db}[_ngcontent-%COMP%]:deep(.p-button){border-radius:8px;font-weight:500;transition:all .15s ease-in-out;padding:.75rem 1.5rem}[_ngcontent-%COMP%]:deep(.p-button).p-button-outlined{background:transparent}[_ngcontent-%COMP%]:deep(.p-button).p-button-outlined:enabled:hover{background:var(--surface-100)}[_ngcontent-%COMP%]:deep(.p-button)[severity=primary]{background:var(--primary-500, #3b82f6);border-color:var(--primary-500, #3b82f6)}[_ngcontent-%COMP%]:deep(.p-button)[severity=primary]:enabled:hover{background:var(--primary-600, #2563eb);border-color:var(--primary-600, #2563eb)}[_ngcontent-%COMP%]:deep(.p-button)[severity=primary]:enabled:active{background:var(--primary-700, #1d4ed8);border-color:var(--primary-700, #1d4ed8)}[_ngcontent-%COMP%]:deep(.p-button):disabled{opacity:.6;cursor:not-allowed}.text-color-secondary[_ngcontent-%COMP%]{color:#6b7280;font-size:.75rem;line-height:1.4}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.form-section[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}[_ngcontent-%COMP%]:deep(.p-dropdown.p-disabled), [_ngcontent-%COMP%]:deep(.p-inputtext:disabled), [_ngcontent-%COMP%]:deep(.p-calendar.p-disabled){background-color:#f9fafb;color:#6b7280;cursor:not-allowed}@media (prefers-color-scheme: dark){.form-section[_ngcontent-%COMP%]{background:#1f2937;border-color:#374151;color:#f9fafb}.section-header[_ngcontent-%COMP%]{border-color:#374151}.field-label[_ngcontent-%COMP%]{color:#e5e7eb}.field-textarea[_ngcontent-%COMP%]{background:#374151;border-color:#4b5563;color:#f9fafb}.field-textarea[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.supplier-info[_ngcontent-%COMP%], .conversion-info[_ngcontent-%COMP%]{background:#374151;border-color:#4b5563}}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%]{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}.field-input[_ngcontent-%COMP%]:focus-visible, .field-textarea[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--primary-500, #3b82f6);outline-offset:2px}@media (max-width: 480px){.expense-form[_ngcontent-%COMP%]{padding:.75rem}.form-section[_ngcontent-%COMP%]{padding:.75rem;border-radius:8px}.section-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:.5rem}.section-header[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{align-self:flex-start}.form-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem}}"]})};var vr=["ExpenseListComponent"];function Er(n,t){if(n&1){let e=E();r(0,"div",13),_("click",function(){h(e);let o=d();return g(o.closeFormModal())}),r(1,"div",14),_("click",function(o){return h(e),g(o.stopPropagation())}),r(2,"div",15)(3,"h3",16),c(4),a(),r(5,"p-button",17),_("onClick",function(){h(e);let o=d();return g(o.closeFormModal())}),a()(),r(6,"div",18)(7,"app-expense-form",19),_("onSave",function(o){h(e);let l=d();return g(l.onSaveExpense(o))})("onCancel",function(){h(e);let o=d();return g(o.closeFormModal())}),a()()()()}if(n&2){let e=d();s(4),I(e.editMode?"Modifier la d\xE9pense":"Nouvelle d\xE9pense"),s(),p("text",!0),s(2),p("expense",e.selectedExpense)("editMode",e.editMode)}}var st=class n{expenseService=v(Z);messageService=v(re);confirmationService=v(ut);logger=v(be);expenseListComponent;selectedExpense=null;selectedExpenses=[];statistics=null;loading=!1;editMode=!1;showFormModal=!1;showStatsPanel=!0;viewMode="list";selectionMode=!1;destroy$=new q;ngOnInit(){this.loadStatistics(),this.logger.info("ExpensesComponent initialis\xE9")}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadStatistics(){this.expenseService.getExpenseStatistics().pipe(b(this.destroy$)).subscribe({next:t=>{this.statistics=t,this.logger.debug("Statistiques charg\xE9es",t)},error:t=>{this.logger.error("Erreur lors du chargement des statistiques",t),this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de charger les statistiques"})}})}refreshData(){this.loadStatistics()}showNewExpenseForm(){this.selectedExpense=null,this.editMode=!1,this.showFormModal=!0,this.logger.info("Ouverture du formulaire de cr\xE9ation")}closeFormModal(){this.showFormModal=!1,this.selectedExpense=null,this.editMode=!1,this.logger.debug("Fermeture du formulaire")}onEditExpense(t){if(!this.canEditExpense(t)){this.messageService.add({severity:"warn",summary:"Action non autoris\xE9e",detail:`Cette d\xE9pense ne peut pas \xEAtre modifi\xE9e (statut: ${Q[t.statut]})`});return}this.selectedExpense=le({},t),this.editMode=!0,this.showFormModal=!0,this.logger.info("\xC9dition d\xE9pense",{id:t.id,numero:t.numero})}onDeleteExpense(t){if(!this.canDeleteExpense(t)){this.messageService.add({severity:"warn",summary:"Action non autoris\xE9e",detail:`Cette d\xE9pense ne peut pas \xEAtre supprim\xE9e (statut: ${Q[t.statut]})`});return}this.confirmationService.confirm({message:`\xCAtes-vous s\xFBr de vouloir supprimer la d\xE9pense "${t.titre}" (${t.numero}) ?`,header:"Confirmation de suppression",icon:"pi pi-exclamation-triangle",acceptLabel:"Oui, supprimer",rejectLabel:"Annuler",acceptButtonStyleClass:"p-button-danger",accept:()=>{this.deleteExpense(t)}})}deleteExpense(t){this.expenseService.deleteExpense(t.id).pipe(b(this.destroy$)).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`D\xE9pense "${t.numero}" supprim\xE9e avec succ\xE8s`}),this.refreshData(),this.logger.info("D\xE9pense supprim\xE9e",{id:t.id})},error:e=>{this.logger.error("Erreur lors de la suppression",e),this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de supprimer la d\xE9pense"})}})}onStatusChange(t){let{expense:e,status:i}=t;if(!this.canChangeStatus(e,i)){this.messageService.add({severity:"warn",summary:"Action non autoris\xE9e",detail:`Impossible de changer le statut vers "${Q[i]}"`});return}if(i==="REJETEE"){this.confirmRejectExpense(e);return}let o={statut:i,commentaire:this.getDefaultStatusComment(i)};this.changeExpenseStatus(e,o)}confirmRejectExpense(t){this.confirmationService.confirm({message:`\xCAtes-vous s\xFBr de vouloir rejeter la d\xE9pense "${t.titre}" ?`,header:"Confirmation de rejet",icon:"pi pi-exclamation-triangle",acceptLabel:"Oui, rejeter",rejectLabel:"Annuler",acceptButtonStyleClass:"p-button-danger",accept:()=>{let e={statut:"REJETEE",commentaire:"D\xE9pense rejet\xE9e depuis la liste"};this.changeExpenseStatus(t,e)}})}changeExpenseStatus(t,e){this.expenseService.changeExpenseStatus(t.id,e).pipe(b(this.destroy$)).subscribe({next:i=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`Statut chang\xE9 vers "${Q[e.statut]}"`}),this.refreshData(),this.logger.info("Statut de d\xE9pense chang\xE9",{id:t.id,oldStatus:t.statut,newStatus:e.statut})},error:i=>{this.logger.error("Erreur lors du changement de statut",i),this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de changer le statut"})}})}onSaveExpense(t){let e=this.editMode?"mise \xE0 jour":"cr\xE9ation";this.editMode&&this.selectedExpense?this.updateExpense(this.selectedExpense.id,t):this.createExpense(t)}createExpense(t){this.expenseService.createExpense(t).pipe(b(this.destroy$)).subscribe({next:e=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`D\xE9pense "${e.numero}" cr\xE9\xE9e avec succ\xE8s`}),this.refreshData(),this.closeFormModal(),this.logger.info("D\xE9pense cr\xE9\xE9e",{id:e.id})},error:e=>{this.logger.error("Erreur lors de la cr\xE9ation",e),this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de cr\xE9er la d\xE9pense"})}})}updateExpense(t,e){this.expenseService.updateExpense(t,e).pipe(b(this.destroy$)).subscribe({next:i=>{this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`D\xE9pense "${i.numero}" mise \xE0 jour avec succ\xE8s`}),this.refreshData(),this.closeFormModal(),this.logger.info("D\xE9pense mise \xE0 jour",{id:i.id})},error:i=>{this.logger.error("Erreur lors de la mise \xE0 jour",i),this.messageService.add({severity:"error",summary:"Erreur",detail:"Impossible de mettre \xE0 jour la d\xE9pense"})}})}onSelectionChange(t){this.selectedExpenses=t,this.logger.debug("S\xE9lection chang\xE9e",{count:t.length})}toggleSelectionMode(){this.selectionMode=!this.selectionMode,this.selectedExpenses=[],this.logger.info("Mode s\xE9lection",{enabled:this.selectionMode})}approveSelectedExpenses(){if(this.selectedExpenses.length===0)return;let t=this.selectedExpenses.filter(e=>this.canChangeStatus(e,"APPROUVEE"));if(t.length===0){this.messageService.add({severity:"warn",summary:"Attention",detail:"Aucune d\xE9pense s\xE9lectionn\xE9e ne peut \xEAtre approuv\xE9e"});return}this.confirmationService.confirm({message:`Approuver ${t.length} d\xE9pense(s) s\xE9lectionn\xE9e(s) ?`,header:"Confirmation d'approbation",icon:"pi pi-question-circle",acceptLabel:"Oui, approuver",rejectLabel:"Annuler",accept:()=>{this.processBatchStatusChange(t,"APPROUVEE")}})}rejectSelectedExpenses(){if(this.selectedExpenses.length===0)return;let t=this.selectedExpenses.filter(e=>this.canChangeStatus(e,"REJETEE"));if(t.length===0){this.messageService.add({severity:"warn",summary:"Attention",detail:"Aucune d\xE9pense s\xE9lectionn\xE9e ne peut \xEAtre rejet\xE9e"});return}this.confirmationService.confirm({message:`Rejeter ${t.length} d\xE9pense(s) s\xE9lectionn\xE9e(s) ?`,header:"Confirmation de rejet",icon:"pi pi-exclamation-triangle",acceptLabel:"Oui, rejeter",rejectLabel:"Annuler",acceptButtonStyleClass:"p-button-danger",accept:()=>{this.processBatchStatusChange(t,"REJETEE")}})}deleteSelectedExpenses(){if(this.selectedExpenses.length===0)return;let t=this.selectedExpenses.filter(e=>this.canDeleteExpense(e));if(t.length===0){this.messageService.add({severity:"warn",summary:"Attention",detail:"Aucune d\xE9pense s\xE9lectionn\xE9e ne peut \xEAtre supprim\xE9e"});return}this.confirmationService.confirm({message:`Supprimer d\xE9finitivement ${t.length} d\xE9pense(s) s\xE9lectionn\xE9e(s) ?`,header:"Confirmation de suppression",icon:"pi pi-exclamation-triangle",acceptLabel:"Oui, supprimer",rejectLabel:"Annuler",acceptButtonStyleClass:"p-button-danger",accept:()=>{this.processBatchDelete(t)}})}processBatchStatusChange(t,e){let i=0,o=0;t.forEach(l=>{let m={statut:e,commentaire:`Changement en lot vers ${Q[e]}`};this.expenseService.changeExpenseStatus(l.id,m).pipe(b(this.destroy$)).subscribe({next:()=>{i++,this.checkBatchCompletion(i,o,t.length,"changement de statut")},error:()=>{o++,this.checkBatchCompletion(i,o,t.length,"changement de statut")}})})}processBatchDelete(t){let e=0,i=0;t.forEach(o=>{this.expenseService.deleteExpense(o.id).pipe(b(this.destroy$)).subscribe({next:()=>{e++,this.checkBatchCompletion(e,i,t.length,"suppression")},error:()=>{i++,this.checkBatchCompletion(e,i,t.length,"suppression")}})})}checkBatchCompletion(t,e,i,o){t+e===i&&(e===0?this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:`${o} en lot r\xE9ussie (${t}/${i})`}):this.messageService.add({severity:"warn",summary:"Partiellement r\xE9ussi",detail:`${o} en lot: ${t} r\xE9ussies, ${e} \xE9chou\xE9es`}),this.refreshData(),this.selectedExpenses=[])}toggleStatsPanel(){this.showStatsPanel=!this.showStatsPanel}changeViewMode(t){this.viewMode=t,this.logger.info("Mode d'affichage chang\xE9",{mode:t})}canEditExpense(t){return t.statut==="EN_ATTENTE"||t.statut==="REJETEE"}canDeleteExpense(t){return t.statut==="EN_ATTENTE"||t.statut==="REJETEE"}canChangeStatus(t,e){switch(t.statut){case"EN_ATTENTE":return e==="APPROUVEE"||e==="REJETEE";case"APPROUVEE":return e==="PAYEE"||e==="EN_ATTENTE";case"REJETEE":return e==="EN_ATTENTE";case"PAYEE":return e==="EN_ATTENTE";default:return!1}}getDefaultStatusComment(t){switch(t){case"APPROUVEE":return"D\xE9pense approuv\xE9e depuis la liste";case"REJETEE":return"D\xE9pense rejet\xE9e depuis la liste";case"PAYEE":return"D\xE9pense marqu\xE9e comme pay\xE9e";case"EN_ATTENTE":return"D\xE9pense remise en attente";default:return""}}formatCurrency(t){return new Intl.NumberFormat("fr-SN",{style:"currency",currency:"XOF",minimumFractionDigits:0}).format(t)}get hasSelectedExpenses(){return this.selectedExpenses.length>0}get selectedExpensesCount(){return this.selectedExpenses.length}get canApproveSelection(){return this.selectedExpenses.some(t=>this.canChangeStatus(t,"APPROUVEE"))}get canRejectSelection(){return this.selectedExpenses.some(t=>this.canChangeStatus(t,"REJETEE"))}get canDeleteSelection(){return this.selectedExpenses.some(t=>this.canDeleteExpense(t))}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=P({type:n,selectors:[["app-expenses"]],viewQuery:function(e,i){if(e&1&&W(vr,5),e&2){let o;C(o=y())&&(i.expenseListComponent=o.first)}},features:[Y([re,ut])],decls:17,vars:4,consts:[[1,"layout-content"],[1,"card","mb-5"],[1,"flex","flex-col","lg:flex-row","lg:justify-between","lg:align-middle"],[1,"mb-3","lg:mb-0"],[1,"flex","align-items-center","mb-2"],[1,"pi","pi-wallet","text-orange-600","text-2xl","mr-3"],[1,"text-2xl","font-semibold","text-900","m-0"],[1,"text-600","m-0","line-height-3"],[1,"flex","flex-column","sm:flex-row","gap-2"],["icon","pi pi-plus","label","Nouvelle d\xE9pense",1,"p-button-primary",3,"onClick"],["class","fixed-modal-overlay",3,"click",4,"ngIf"],[1,"card","mt-3"],[3,"onEdit","onDelete","onStatusChange","onSelectionChange","showFilters","showActions","selectionMode"],[1,"fixed-modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"text-xl","font-semibold"],["icon","pi pi-times",3,"onClick","text"],[1,"modal-body"],[3,"onSave","onCancel","expense","editMode"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),f(5,"i",5),r(6,"h1",6),c(7,"Gestion des D\xE9penses"),a()(),r(8,"p",7),c(9," Suivi et gestion des d\xE9penses de l'entreprise "),a()(),r(10,"div",8)(11,"p-button",9),_("onClick",function(){return i.showNewExpenseForm()}),a()()()(),u(12,Er,8,4,"div",10),r(13,"div",11)(14,"app-expense-list",12),_("onEdit",function(l){return i.onEditExpense(l)})("onDelete",function(l){return i.onDeleteExpense(l)})("onStatusChange",function(l){return i.onStatusChange(l)})("onSelectionChange",function(l){return i.onSelectionChange(l)}),a()()(),f(15,"p-toast")(16,"p-confirmDialog")),e&2&&(s(12),p("ngIf",i.showFormModal),s(2),p("showFilters",!1)("showActions",!0)("selectionMode",!1))},dependencies:[U,k,Qt,Ee,ve,Kt,Jt,en,Zt,Gt,qe,wn,Mn,rt,at],styles:["[_nghost-%COMP%]{display:block}.layout-content[_ngcontent-%COMP%]{padding:1rem}.fixed-modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background:#00000080;z-index:1000;display:flex;align-items:center;justify-content:center;padding:1rem}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 4px 20px #00000026;max-width:900px;width:100%;max-height:90vh;display:flex;flex-direction:column}.modal-header[_ngcontent-%COMP%]{padding:1.5rem;border-bottom:1px solid var(--surface-200);display:flex;justify-content:space-between;align-items:center}.modal-body[_ngcontent-%COMP%]{padding:1.5rem;overflow-y:auto;flex:1}.stat-card[_ngcontent-%COMP%]{transition:transform .2s}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}  .p-card{box-shadow:0 2px 4px #0000001a;border:1px solid var(--surface-200)}  .p-card .p-card-body{padding:1rem}"]})};var Pl=[{path:"list",component:st}];export{Pl as default};
